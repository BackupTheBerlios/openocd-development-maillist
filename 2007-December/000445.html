<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] To clearMalloc or not to clearMalloc
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2007-December/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20To%20clearMalloc%20or%20not%20to%20clearMalloc&In-Reply-To=%3Cc09652430712132335h2f9b1409h65602e700fced72%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000444.html">
   <LINK REL="Next"  HREF="000446.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] To clearMalloc or not to clearMalloc</H1>
    <B>&#216;yvind Harboe</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20To%20clearMalloc%20or%20not%20to%20clearMalloc&In-Reply-To=%3Cc09652430712132335h2f9b1409h65602e700fced72%40mail.gmail.com%3E"
       TITLE="[Openocd-development] To clearMalloc or not to clearMalloc">oyvind.harboe at zylin.com
       </A><BR>
    <I>Fri Dec 14 08:35:48 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000444.html">[Openocd-development] To clearMalloc or not to clearMalloc
</A></li>
        <LI>Next message: <A HREF="000446.html">[Openocd-development] To clearMalloc or not to clearMalloc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#445">[ date ]</a>
              <a href="thread.html#445">[ thread ]</a>
              <a href="subject.html#445">[ subject ]</a>
              <a href="author.html#445">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Dec 13, 2007 11:54 PM, Michael Fischer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">fischermi at t-online.de</A>&gt; wrote:
&gt;<i> Hello List,
</I>&gt;<i>
</I>&gt;<i> I have now used 0xff instead of 0x00 to clear the memory.
</I>&gt;<i> And now OpenOCD crashs if I use &quot;flash erase_check 0&quot; to an CFI
</I>&gt;<i> flash. Perhaps this will help us?
</I>
How about the attached patch?

I added a macro to replace malloc() with OCDMalloc() which fills in
allocated memory with 0x55.

Obviously the macro can be commented out to revert to the original
behaviour, e.g. when running Valgrind.

NB! There is something screwy with my patch program(Subclipse) that
causes it to introduce no-op sections (replace A with A), so the patch
looks bigger than it is. Apply it and diff against Subversion to see
actual changes which a handful of lines.


-- 
&#216;yvind Harboe
<A HREF="http://www.zylin.com">http://www.zylin.com</A> - eCos ARM &amp; FPGA  developer kit
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: fillmem.txt
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20071214/85d81d15/attachment.txt">https://lists.berlios.de/pipermail/openocd-development/attachments/20071214/85d81d15/attachment.txt</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000444.html">[Openocd-development] To clearMalloc or not to clearMalloc
</A></li>
	<LI>Next message: <A HREF="000446.html">[Openocd-development] To clearMalloc or not to clearMalloc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#445">[ date ]</a>
              <a href="thread.html#445">[ thread ]</a>
              <a href="subject.html#445">[ subject ]</a>
              <a href="author.html#445">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
