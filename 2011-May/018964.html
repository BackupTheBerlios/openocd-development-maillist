<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] Why not default halt the target when GDB connects to OpenOCD?
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2011-May/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Why%20not%20default%20halt%20the%20target%20when%20GDB%0A%20connects%20to%20OpenOCD%3F&In-Reply-To=%3C4DBF0B6E.1040002%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018963.html">
   <LINK REL="Next"  HREF="018966.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?</H1>
    <B>Michael Trensch</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Why%20not%20default%20halt%20the%20target%20when%20GDB%0A%20connects%20to%20OpenOCD%3F&In-Reply-To=%3C4DBF0B6E.1040002%40gmail.com%3E"
       TITLE="[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?">mtrensch at googlemail.com
       </A><BR>
    <I>Mon May  2 21:52:14 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="018963.html">[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?
</A></li>
        <LI>Next message: <A HREF="018966.html">[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18964">[ date ]</a>
              <a href="thread.html#18964">[ thread ]</a>
              <a href="subject.html#18964">[ subject ]</a>
              <a href="author.html#18964">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I often use openOCD and GDB/Insight to attach to a running target that I
don't want to halt, or even cannot halt it during my debugging session.
I just want to take to see the call stack and program counter when it
crashes or when it reaches a special code line.

It's not a good idea to force everyone to halt their target when
connecting, when there is the possibility to script this behavior. It
might be your case that you want to halt it, but some other may not want
that.

In your case I think it would be the best to write a &quot;gdb-attach&quot; event
in your script and you can do whatever you want, like resetting the CPU,
blink LED's in this script.

Regards,
Michael

On 02.05.2011 21:14, Jie Zhang wrote:
&gt;<i> When GDB connects to OpenOCD, OpenOCD does not halt the target by
</I>&gt;<i> default. To halt the target, users have to add &quot;halt&quot; to gdb-attach
</I>&gt;<i> event hook in target configuration file or type the command &quot;monitor
</I>&gt;<i> halt&quot; from GDB command line interface. The latter method caused some
</I>&gt;<i> confusion for me.
</I>&gt;<i>
</I>&gt;<i> Since OpenOCD does not halt the target when GDB connects, it will
</I>&gt;<i> return all zeros when GDB asks for register value. GDB cached such
</I>&gt;<i> value internally. Then I typed &quot;monitor halt&quot; in GDB, OpenOCD halts
</I>&gt;<i> the target. But when I ask GDB about the register value of the target,
</I>&gt;<i> GDB still returns the cached all zeros to me without retrieving them
</I>&gt;<i> again. This bacause GDB has no idea that the target is still running
</I>&gt;<i> when it connects to OpenOCD and the target is halted by &quot;monitor
</I>&gt;<i> halt&quot;. To get meaningful register values, I have to &quot;continue&quot; and
</I>&gt;<i> &quot;^C&quot; in GDB to cause GDB to retrieve register values again.
</I>&gt;<i>
</I>&gt;<i> Then my question is why not just halt the target when GDB connects to
</I>&gt;<i> OpenOCD? In this way, GDB will get the correct register information
</I>&gt;<i> when it connects to OpenOCD and show the correct stop address.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> Jie
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Openocd-development mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">Openocd-development at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">https://lists.berlios.de/mailman/listinfo/openocd-development</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018963.html">[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?
</A></li>
	<LI>Next message: <A HREF="018966.html">[Openocd-development] Why not default halt the target when GDB connects to OpenOCD?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18964">[ date ]</a>
              <a href="thread.html#18964">[ thread ]</a>
              <a href="subject.html#18964">[ subject ]</a>
              <a href="author.html#18964">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
