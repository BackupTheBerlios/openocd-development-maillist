<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] STM32 flash write speed
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2010-October/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20STM32%20flash%20write%20speed&In-Reply-To=%3C4CBD36AB.9050509%40amontec.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016776.html">
   <LINK REL="Next"  HREF="016778.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] STM32 flash write speed</H1>
    <B>Laurent Gauch</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20STM32%20flash%20write%20speed&In-Reply-To=%3C4CBD36AB.9050509%40amontec.com%3E"
       TITLE="[Openocd-development] STM32 flash write speed">laurent.gauch at amontec.com
       </A><BR>
    <I>Tue Oct 19 08:11:55 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="016776.html">[Openocd-development] STM32 flash write speed
</A></li>
        <LI>Next message: <A HREF="016778.html">[Openocd-development] USB latency limiting JTAG speed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16777">[ date ]</a>
              <a href="thread.html#16777">[ thread ]</a>
              <a href="subject.html#16777">[ subject ]</a>
              <a href="author.html#16777">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> On 2010-10-18 21:53, Andreas Fritiofson wrote:
</I>&gt;<i> &gt;/ Well, that's BS. The STM32 flash has a nominal programming time of
</I>&gt;<i> /&gt;/ 52.5&#181;s per 16 bits. So the theoretical max speed anyone can achieve is
</I>&gt;<i> /&gt;/ roughly 37.2 KiBytes/s. If you see claims of speeds way above that
</I>&gt;<i> /&gt;/ they're either lies, load-to-ram figures or a mixup in units.
</I>&gt;<i> /
</I>&gt;<i> That's the screenshot
</I>&gt;<i> <A HREF="http://obrazki.elektroda.net/56_1286356404.jpg">http://obrazki.elektroda.net/56_1286356404.jpg</A>
</I>&gt;<i>
</I>&gt;<i> &gt;/ That said, I think it should be possible to crank up the STM32 flash
</I>&gt;<i> /&gt;/ programming speed in OpenOCD by at least a factor of two. I don't know
</I>&gt;<i> /&gt;/ what the bottleneck is, but like you I have concluded that JTAG
</I>&gt;<i> /&gt;/ frequency is not the major issue here. My guess is that the
</I>&gt;<i> /&gt;/ programming algorithm we use might be quite inefficient. USB latency
</I>&gt;<i> /&gt;/ might play a role but with double buffering and other tricks in the
</I>&gt;<i> /&gt;/ algorithm the latency shouldn't be a limiting factor.
</I>&gt;<i> /
</I>&gt;<i> That would be very cool to tune OpenOCD up!
</I>&gt;<i>   
</I>
That's a real good point for Rowley Crossworks 
<A HREF="http://www.rowley.co.uk/arm/index.htm">http://www.rowley.co.uk/arm/index.htm</A> and Amontec JTAGkey Series 
<A HREF="http://www.amontec.com">http://www.amontec.com</A> . Note, with the use of Amontec JTAGkey-2 based 
on high-speed USB, Rowley Crossworks becomes still a lot faster since 
the USB latency go form 1ms to 125us.

For the OpenOCD, we know there are some optimizations do be done on the 
software to accelerate the USB JTAG cable.

Could you please let me know the same as

<A HREF="http://obrazki.elektroda.net/56_1286356404.jpg">http://obrazki.elektroda.net/56_1286356404.jpg</A>

but for OpenOCD without and with the debug output -d3. (the debug output 
could add some delay ;-) )

The debug output file could help to know how many times the JTAG_EXECUTE 
is done from OpenOCD. Also, this could let us know if and where we could 
remove JTAG_EXECUTE for optimization of the OpenOCD using USB JTAG Cable.

Removing the effect of the USB latency is a real challenge, and it was a 
challenge from the begin of OpenOCD in 2004.
The advantage of USB JTAG Dongle could make your debug interface at 
really low cost (as tha Amonte JTAGkey Tiny @ &#8364;29.-) regarding Embedded 
System running OpenOCD on an external processor @ &#8364;750.- .
Also, having low cost USB JTAG solution helped and help to have more and 
more OpenOCD developers from 2004.

* For me, the low cost USB JTAG solutions is the only reason of the 
OpenOCD success. *

We could speed-up OpenOCD as fast as Rowley Crossworks, for sure !

Regards,
Laurent
<A HREF="http://www.amontec.com">http://www.amontec.com</A>






</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016776.html">[Openocd-development] STM32 flash write speed
</A></li>
	<LI>Next message: <A HREF="016778.html">[Openocd-development] USB latency limiting JTAG speed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16777">[ date ]</a>
              <a href="thread.html#16777">[ thread ]</a>
              <a href="subject.html#16777">[ subject ]</a>
              <a href="author.html#16777">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
