<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] IAP with STM32 Cortex M3
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20IAP%20with%20STM32%20Cortex%20M3&In-Reply-To=%3C49F0FCBB.9070506%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005682.html">
   <LINK REL="Next"  HREF="005659.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] IAP with STM32 Cortex M3</H1>
    <B>Michel Catudal</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20IAP%20with%20STM32%20Cortex%20M3&In-Reply-To=%3C49F0FCBB.9070506%40gmail.com%3E"
       TITLE="[Openocd-development] IAP with STM32 Cortex M3">michelcatudal at gmail.com
       </A><BR>
    <I>Fri Apr 24 01:41:47 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005682.html">[Openocd-development] IAP with STM32 Cortex M3
</A></li>
        <LI>Next message: <A HREF="005659.html">[Openocd-development] [PATCH] Drop unnecessary STM32 BSTAPIDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5685">[ date ]</a>
              <a href="thread.html#5685">[ thread ]</a>
              <a href="subject.html#5685">[ subject ]</a>
              <a href="author.html#5685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gene Smith a &#233;crit :
&gt;<i> Spencer Oliver wrote:
</I>&gt;<i>   
</I>&gt;&gt;&gt;<i> This is a bit off topic for this list but thought I would ask 
</I>&gt;&gt;&gt;<i> since quite a bit of discussion on programming STM32 is here.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This is in regard to &quot;in-application programming&quot; (IAP) mentioned in
</I>&gt;&gt;&gt;<i> PM0042 Programming manual. Does this mean that your 
</I>&gt;&gt;&gt;<i> application running in flash can program flash without moving 
</I>&gt;&gt;&gt;<i> the code to RAM?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>       
</I>&gt;&gt;<i> Yes this can be done on the stm32
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers
</I>&gt;&gt;<i> Spen
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks for verifying this. I also found an app note AN2557 and some 
</I>&gt;<i> sample code on how to do this:
</I>&gt;<i> <A HREF="http://www.st.com/stonline/products/literature/an/13588.pdf">http://www.st.com/stonline/products/literature/an/13588.pdf</A>
</I>&gt;<i>
</I>&gt;<i>   
</I>There is also an example of a bootloader with serial. I wrote a
bootloader that uses the CAN so I can upgrade my software by connecting
to the diagnostic connector in the vehicle. I haven't tested it with GCC
yet but there was an issue with IAR where the program would crash
shortly after
I would jump to the new application. It turned out that IAR was poping
some data off the stack which brought the stack 8 bytes too high.
This is with the lastest IAR. Bringing the stack 8 bytes lower to start
with fixed the problem. All I was doing was like in the appnote, jump
indirectly to
the code using the address in the new vector table.

ST must have two charge pumps so you can run code in a block while
programming the other one. This is very nice, for most processors you must
run out of RAM to do that. The bus is stalled a bit when you write the
flash. In the small application that I have done I use 2 sectors as
EEPROM simulation.

Michel

-- 
Tired of Microsoft's rebootive multitasking?
then it's time to upgrade to Linux.
<A HREF="http://home.comcast.net/~mcatudal">http://home.comcast.net/~mcatudal</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005682.html">[Openocd-development] IAP with STM32 Cortex M3
</A></li>
	<LI>Next message: <A HREF="005659.html">[Openocd-development] [PATCH] Drop unnecessary STM32 BSTAPIDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5685">[ date ]</a>
              <a href="thread.html#5685">[ thread ]</a>
              <a href="subject.html#5685">[ subject ]</a>
              <a href="author.html#5685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
