<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] [PATCH] CMake scripts
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPATCH%5D%20CMake%20scripts&In-Reply-To=%3CC469EC90-C021-4B50-BD03-D597C9912ACC%40kc8apf.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005360.html">
   <LINK REL="Next"  HREF="005362.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] [PATCH] CMake scripts</H1>
    <B>Rick Altherr</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPATCH%5D%20CMake%20scripts&In-Reply-To=%3CC469EC90-C021-4B50-BD03-D597C9912ACC%40kc8apf.net%3E"
       TITLE="[Openocd-development] [PATCH] CMake scripts">kc8apf at kc8apf.net
       </A><BR>
    <I>Fri Apr 17 04:02:32 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005360.html">[Openocd-development] [PATCH] CMake scripts
</A></li>
        <LI>Next message: <A HREF="005362.html">[Openocd-development] [PATCH] CMake scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5361">[ date ]</a>
              <a href="thread.html#5361">[ thread ]</a>
              <a href="subject.html#5361">[ subject ]</a>
              <a href="author.html#5361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Apr 16, 2009, at 6:57 PM, Dick Hollenbeck wrote:

&gt;<i> This is a comprehensive patch.
</I>&gt;<i>
</I>&gt;<i> A number of problems were fixed.
</I>&gt;<i>
</I>&gt;<i> It builds basically *all* the possible drivers now, and support  
</I>&gt;<i> static libraries for libusb and libftdi.  The only one that gave me  
</I>&gt;<i> grief is ecosboard, but I think that requires some headers not  
</I>&gt;<i> present?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> There still needs to be some
</I>&gt;<i>
</I>&gt;<i> if(APPLE)
</I>&gt;<i> endif(APPLE)
</I>&gt;<i>
</I>&gt;<i> lines added for static libraries on APPLE.
</I>&gt;<i>
</I>
These should be called MACOS_X as Apple is a company, not a product or  
OS.

&gt;<i> (but this is easy to do and probably will only ever effect MICHAEL.)
</I>
I'm solely on OS X and could be affected, but I tend to use dynamic  
libraries.

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Somebody please commit it.
</I>&gt;<i>
</I>There is still some open discussion on whether or not the project  
wants to.

&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Dick
</I>&gt;<i>
</I>&gt;<i> Index: src/helper/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/helper/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/helper/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,43 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +add_executable(bin2char bin2char.c)
</I>&gt;<i> +add_custom_command(
</I>&gt;<i> +    OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/startup_tcl.c
</I>&gt;<i> +    COMMAND bin2char startup_tcl &lt; ${CMAKE_CURRENT_SOURCE_DIR}/ 
</I>&gt;<i> startup.tcl &gt; ${CMAKE_CURRENT_BINARY_DIR}/startup_tcl.c
</I>&gt;<i> +    DEPENDS bin2char ${CMAKE_CURRENT_SOURCE_DIR}/startup.tcl
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +set( HELPER_SRCS
</I>&gt;<i> +   binarybuffer.c
</I>&gt;<i> +   command.c
</I>&gt;<i> +   configuration.c
</I>&gt;<i> +   fileio.c
</I>&gt;<i> +   log.c
</I>&gt;<i> +   replacements.c
</I>&gt;<i> +   ${CMAKE_CURRENT_BINARY_DIR}/startup_tcl.c
</I>&gt;<i> +   time_support.c
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(NOT BUILD_ECOSBOARD)
</I>&gt;<i> +
</I>&gt;<i> +    # omit these sources if building ecosboard, otherwise include  
</I>&gt;<i> them
</I>&gt;<i> +    set( HELPER_SRCS ${HELPER_SRCS} options.c jim.c jim-eventloop.c )
</I>&gt;<i> +
</I>&gt;<i> +endif(NOT BUILD_ECOSBOARD)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_IOUTIL)
</I>&gt;<i> +
</I>&gt;<i> +    # add these souces if BUILD_IOUTIL
</I>&gt;<i> +    set( HELPER_SRCS ${HELPER_SRCS} ioutil.c )
</I>&gt;<i> +
</I>&gt;<i> +endif(BUILD_IOUTIL)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +add_library(helper STATIC ${HELPER_SRCS})
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/helper/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/pld/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/pld/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/pld/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,11 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +SET(PLD_SRCS
</I>&gt;<i> +   pld.c
</I>&gt;<i> +   xilinx_bit.c
</I>&gt;<i> +   virtex2.c
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +add_library(pld STATIC ${PLD_SRCS})
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/pld/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/jtag/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/jtag/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/jtag/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,78 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +include_directories(
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/rlink
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +set(JTAG_SRCS jtag.c)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_BITBANG OR BUILD_DUMMY OR BUILD_EP93XX OR BUILD_ECOSBOARD  
</I>&gt;<i> OR BUILD_PARPORT OR BUILD_AT91RM9200)
</I>&gt;<i> +    list(APPEND JTAG_SRCS bitbang.c)
</I>&gt;<i> +endif(BUILD_BITBANG OR BUILD_DUMMY OR BUILD_EP93XX OR  
</I>&gt;<i> BUILD_ECOSBOARD OR BUILD_PARPORT OR BUILD_AT91RM9200)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_PARPORT)
</I>&gt;<i> +    list(APPEND JTAG_SRCS parport.c)
</I>&gt;<i> +endif(BUILD_PARPORT)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_DUMMY)
</I>&gt;<i> +    list(APPEND JTAG_SRCS dummy.c)
</I>&gt;<i> +endif(BUILD_DUMMY)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_FT2232_FTD2XX OR BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +    list(APPEND JTAG_SRCS ft2232.c)
</I>&gt;<i> +endif(BUILD_FT2232_FTD2XX OR BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_AMTJTAGACCEL)
</I>&gt;<i> +    list(APPEND JTAG_SRCS amt_jtagaccel.c)
</I>&gt;<i> +endif(BUILD_AMTJTAGACCEL)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_EP93XX)
</I>&gt;<i> +    list(APPEND JTAG_SRCS ep93xx.c)
</I>&gt;<i> +endif(BUILD_EP93XX)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_AT91RM9200)
</I>&gt;<i> +    list(APPEND JTAG_SRCS at91rm9200.c)
</I>&gt;<i> +endif(BUILD_AT91RM9200)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_GW16012)
</I>&gt;<i> +    list(APPEND JTAG_SRCS gw16012.c)
</I>&gt;<i> +endif(BUILD_GW16012)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_BITQ)
</I>&gt;<i> +    list(APPEND JTAG_SRCS bitq.c)
</I>&gt;<i> +endif(BUILD_BITQ)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_PRESTO)
</I>&gt;<i> +    list(APPEND JTAG_SRCS presto.c)
</I>&gt;<i> +endif(BUILD_PRESTO)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_USBPROG)
</I>&gt;<i> +    list(APPEND JTAG_SRCS usbprog.c)
</I>&gt;<i> +endif(BUILD_USBPROG)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_ECOSBOARD)
</I>&gt;<i> +    list(APPEND JTAG_SRCS zy1000.c)
</I>&gt;<i> +endif(BUILD_ECOSBOARD)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_JLINK)
</I>&gt;<i> +    list(APPEND JTAG_SRCS jlink.c)
</I>&gt;<i> +endif(BUILD_JLINK)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_RLINK)
</I>&gt;<i> +    list(APPEND JTAG_SRCS rlink/rlink.c rlink/rlink_speed_table.c)
</I>&gt;<i> +endif(BUILD_RLINK)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_VSLLINK)
</I>&gt;<i> +    list(APPEND JTAG_SRCS vsllink.c)
</I>&gt;<i> +endif(BUILD_VSLLINK)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_ARM_JTAG_EW)
</I>&gt;<i> +    list(APPEND JTAG_SRCS arm-jtag-ew.c)
</I>&gt;<i> +endif(BUILD_ARM_JTAG_EW)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +add_library(jtag STATIC ${JTAG_SRCS})
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/jtag/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/target/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/target/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/target/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,74 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +SET(TARGET_SRCS
</I>&gt;<i> +   target.c
</I>&gt;<i> +   register.c
</I>&gt;<i> +   breakpoints.c
</I>&gt;<i> +   armv4_5.c
</I>&gt;<i> +   embeddedice.c
</I>&gt;<i> +   etm.c
</I>&gt;<i> +   arm7tdmi.c
</I>&gt;<i> +   arm9tdmi.c
</I>&gt;<i> +   arm_jtag.c
</I>&gt;<i> +   arm7_9_common.c
</I>&gt;<i> +   algorithm.c
</I>&gt;<i> +   arm920t.c
</I>&gt;<i> +   arm720t.c
</I>&gt;<i> +   armv4_5_mmu.c
</I>&gt;<i> +   armv4_5_cache.c
</I>&gt;<i> +   arm_disassembler.c
</I>&gt;<i> +   arm966e.c
</I>&gt;<i> +   arm926ejs.c
</I>&gt;<i> +   feroceon.c
</I>&gt;<i> +   etb.c
</I>&gt;<i> +   xscale.c
</I>&gt;<i> +   arm_simulator.c
</I>&gt;<i> +   image.c
</I>&gt;<i> +   armv7m.c
</I>&gt;<i> +   cortex_m3.c
</I>&gt;<i> +   cortex_swjdp.c
</I>&gt;<i> +   etm_dummy.c
</I>&gt;<i> +   target_request.c
</I>&gt;<i> +   trace.c
</I>&gt;<i> +   arm11.c
</I>&gt;<i> +   arm11_dbgtap.c
</I>&gt;<i> +   mips32.c
</I>&gt;<i> +   mips_m4k.c
</I>&gt;<i> +   mips32_pracc.c
</I>&gt;<i> +   mips32_dmaacc.c
</I>&gt;<i> +   mips_ejtag.c
</I>&gt;<i> +   )
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_OOCD_TRACE)
</I>&gt;<i> +    list(APPEND TARGET_SRCS oocd_trace.c)
</I>&gt;<i> +endif(BUILD_OOCD_TRACE)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +add_library(target STATIC ${TARGET_SRCS})
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +install(
</I>&gt;<i> +    FILES       xscale/debug_handler.bin
</I>&gt;<i> +    DESTINATION ${OPENOCD_LIBS}/xscale
</I>&gt;<i> +    COMPONENT   xscale/debug_handler
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +install(
</I>&gt;<i> +    FILES       ecos/at91eb40a.elf
</I>&gt;<i> +    DESTINATION ${OPENOCD_LIBS}/ecos
</I>&gt;<i> +    COMPONENT   &quot;ecos/elf stuff&quot;
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +# find all cfg files and install them into the OPENOCD_LIBS directory
</I>&gt;<i> +install(
</I>&gt;<i> +    DIRECTORY   target interface board test
</I>&gt;<i> +    DESTINATION ${OPENOCD_LIBS}
</I>&gt;<i> +    COMPONENT   &quot;tcl configuration files&quot;
</I>&gt;<i> +    FILES_MATCHING PATTERN &quot;*.cfg&quot;
</I>&gt;<i> +    PATTERN      &quot;.svn&quot; EXCLUDE
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/target/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/xsvf/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/xsvf/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/xsvf/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,9 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +set( XSVF_SRCS
</I>&gt;<i> +   xsvf.c
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +add_library(xsvf STATIC ${XSVF_SRCS})
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/xsvf/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/flash/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/flash/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/flash/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,37 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +SET(FLASH_SRCS
</I>&gt;<i> +   flash.c
</I>&gt;<i> +   lpc2000.c
</I>&gt;<i> +   cfi.c
</I>&gt;<i> +   non_cfi.c
</I>&gt;<i> +   at91sam7.c
</I>&gt;<i> +   at91sam7_old.c
</I>&gt;<i> +   str7x.c
</I>&gt;<i> +   str9x.c
</I>&gt;<i> +   aduc702x.c
</I>&gt;<i> +   nand.c
</I>&gt;<i> +   nand_ecc.c
</I>&gt;<i> +   lpc3180_nand_controller.c
</I>&gt;<i> +   stellaris.c
</I>&gt;<i> +   str9xpec.c
</I>&gt;<i> +   stm32x.c
</I>&gt;<i> +   tms470.c
</I>&gt;<i> +   ecos.c
</I>&gt;<i> +   orion_nand.c
</I>&gt;<i> +   s3c24xx_nand.c
</I>&gt;<i> +   s3c2410_nand.c
</I>&gt;<i> +   s3c2412_nand.c
</I>&gt;<i> +   s3c2440_nand.c
</I>&gt;<i> +   s3c2443_nand.c
</I>&gt;<i> +   lpc288x.c
</I>&gt;<i> +   ocl.c
</I>&gt;<i> +   mflash.c
</I>&gt;<i> +   pic32mx.c
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +add_library(flash STATIC ${FLASH_SRCS})
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/flash/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/svf/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/svf/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/svf/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,10 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +SET(SVF_SRCS
</I>&gt;<i> +   svf.c
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +add_library(svf STATIC ${SVF_SRCS})
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/svf/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/server/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/server/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/server/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,32 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +set( SERVER_SRCS
</I>&gt;<i> +   server.c
</I>&gt;<i> +   telnet_server.c
</I>&gt;<i> +   gdb_server.c
</I>&gt;<i> +   tcl_server.c
</I>&gt;<i> +   )
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_HTTPD)
</I>&gt;<i> +    list(APPEND SERVER_SRCS httpd.c)
</I>&gt;<i> +    file(GLOB HTTP_DATA httpd/*.tcl httpd/*.css httpd/menu_cuts/ 
</I>&gt;<i> *.png)
</I>&gt;<i> +    #message( ${HTTP_DATA} )
</I>&gt;<i> +
</I>&gt;<i> +    install(
</I>&gt;<i> +        DIRECTORY   httpd
</I>&gt;<i> +        DESTINATION ${OPENOCD_LIBS}
</I>&gt;<i> +        COMPONENT   &quot;httpd data files&quot;
</I>&gt;<i> +        FILES_MATCHING
</I>&gt;<i> +            PATTERN     &quot;*.tcl&quot;
</I>&gt;<i> +            PATTERN     &quot;*.css&quot;
</I>&gt;<i> +            PATTERN     &quot;*.png&quot;
</I>&gt;<i> +            PATTERN     &quot;.svn&quot; EXCLUDE
</I>&gt;<i> +        )
</I>&gt;<i> +
</I>&gt;<i> +endif(BUILD_HTTPD)
</I>&gt;<i> +
</I>&gt;<i> +add_library(server STATIC ${SERVER_SRCS})
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/server/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/openocd.c
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/openocd.c	(revision 1457)
</I>&gt;<i> +++ src/openocd.c	(working copy)
</I>&gt;<i> @@ -24,8 +24,6 @@
</I>&gt;<i>  *   59 Temple Place - Suite 330, Boston, MA  02111-1307,  
</I>&gt;<i> USA.             *
</I>&gt;<i>   
</I>&gt;<i> ***************************************************************************/
</I>&gt;<i>
</I>&gt;<i> -#define OPENOCD_VERSION &quot;Open On-Chip Debugger &quot; VERSION &quot; (&quot;  
</I>&gt;<i> PKGBLDDATE &quot;) &quot;RELSTR PKGBLDREV
</I>&gt;<i> -
</I>&gt;<i> #ifdef HAVE_CONFIG_H
</I>&gt;<i> #include &quot;config.h&quot;
</I>&gt;<i> #endif
</I>&gt;<i> @@ -57,6 +55,10 @@
</I>&gt;<i> #include &lt;unistd.h&gt;
</I>&gt;<i> #include &lt;errno.h&gt;
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i> +#define OPENOCD_VERSION &quot;Open On-Chip Debugger &quot; VERSION &quot; (&quot;  
</I>&gt;<i> PKGBLDDATE &quot;) &quot;RELSTR PKGBLDREV
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> void print_version(void)
</I>&gt;<i> {
</I>&gt;<i> 	/* DANGER!!! make sure that the line below does not appear in a  
</I>&gt;<i> patch, do not remove */
</I>&gt;<i> Index: src/CMakeModules/FindLibUSB.cmake
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/CMakeModules/FindLibUSB.cmake	(revision 0)
</I>&gt;<i> +++ src/CMakeModules/FindLibUSB.cmake	(revision 0)
</I>&gt;<i> @@ -0,0 +1,61 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +#
</I>&gt;<i> +# - Find libusb library
</I>&gt;<i> +#
</I>&gt;<i> +# Before calling, USE_STATIC_USB may be set to mandate a STATIC  
</I>&gt;<i> library
</I>&gt;<i> +#
</I>&gt;<i> +# This module defines
</I>&gt;<i> +#  LIBUSB_INCLUDE_DIR, where to find usb.h
</I>&gt;<i> +#  LIBUSB_LIBRARIES, the libraries needed to use libusb
</I>&gt;<i> +#  LIBUSB_FOUND, if false, the library was NOT found
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(NOT LIBUSB_FOUND)
</I>&gt;<i> +
</I>&gt;<i> +    if(NOT WIN32 AND NOT LIBUSB_INCLUDE_DIR AND NOT  
</I>&gt;<i> LIBUSB_LIBRARIES )
</I>&gt;<i> +        include(FindPkgConfig)
</I>&gt;<i> +        pkg_check_modules(LIBUSB_PKG libusb)
</I>&gt;<i> +    endif(NOT WIN32 AND NOT LIBUSB_INCLUDE_DIR AND NOT  
</I>&gt;<i> LIBUSB_LIBRARIES )
</I>&gt;<i> +
</I>&gt;<i> +    find_path(LIBUSB_INCLUDE_DIR NAMES usb.h
</I>&gt;<i> +       PATHS
</I>&gt;<i> +       ${LIBUSB_PKG_INCLUDE_DIRS}
</I>&gt;<i> +       /usr/include
</I>&gt;<i> +       /usr/local/include
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_USB)
</I>&gt;<i> +        set(_save ${CMAKE_FIND_LIBRARY_SUFFIXES})
</I>&gt;<i> +        set(CMAKE_FIND_LIBRARY_SUFFIXES $ 
</I>&gt;<i> {CMAKE_STATIC_LIBRARY_SUFFIX})
</I>&gt;<i> +    endif(USE_STATIC_USB)
</I>&gt;<i> +
</I>&gt;<i> +    find_library(LIBUSB_LIBRARIES NAMES usb
</I>&gt;<i> +        PATHS
</I>&gt;<i> +        ${LIBUSB_PKG_LIBRARY_DIRS}
</I>&gt;<i> +        /usr/lib
</I>&gt;<i> +        /usr/local/lib
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_USB)
</I>&gt;<i> +        set(CMAKE_FIND_LIBRARY_SUFFIXES ${_save})
</I>&gt;<i> +    endif(USE_STATIC_USB)
</I>&gt;<i> +
</I>&gt;<i> +    include(FindPackageHandleStandardArgs)
</I>&gt;<i> +
</I>&gt;<i> +    # handle the QUIETLY AND REQUIRED arguments AND set  
</I>&gt;<i> LIBUSB_FOUND to TRUE if
</I>&gt;<i> +    # all listed variables are TRUE
</I>&gt;<i> +    find_package_handle_standard_args(LIBUSB DEFAULT_MSG  
</I>&gt;<i> LIBUSB_LIBRARIES LIBUSB_INCLUDE_DIR)
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_USB)
</I>&gt;<i> +        add_library(libusb STATIC IMPORTED)
</I>&gt;<i> +    else(USE_STATIC_USB)
</I>&gt;<i> +        add_library(libusb SHARED IMPORTED)
</I>&gt;<i> +    endif(USE_STATIC_USB)
</I>&gt;<i> +
</I>&gt;<i> +    set_target_properties(libusb PROPERTIES IMPORTED_LOCATION $ 
</I>&gt;<i> {LIBUSB_LIBRARIES})
</I>&gt;<i> +    set(${LIBUSB_LIBRARIES} libusb)
</I>&gt;<i> +
</I>&gt;<i> +    #mark_as_advanced(LIBUSB_INCLUDE_DIR LIBUSB_LIBRARIES)
</I>&gt;<i> +
</I>&gt;<i> +endif(NOT LIBUSB_FOUND)
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/CMakeModules/FindLibUSB.cmake
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/CMakeModules/FindLibFTD2XX.cmake
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/CMakeModules/FindLibFTD2XX.cmake	(revision 0)
</I>&gt;<i> +++ src/CMakeModules/FindLibFTD2XX.cmake	(revision 0)
</I>&gt;<i> @@ -0,0 +1,70 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +#
</I>&gt;<i> +# - Try to find libftd2xx
</I>&gt;<i> +#
</I>&gt;<i> +# There is no static library for libftd2xx, so a dynamic library is  
</I>&gt;<i> used
</I>&gt;<i> +#
</I>&gt;<i> +# Once done this will define
</I>&gt;<i> +#
</I>&gt;<i> +# LIBFTD2XX_FOUND - system has libftdi
</I>&gt;<i> +# LIBFTD2XX_INCLUDE_DIR - the libftdi include directory
</I>&gt;<i> +# LIBFTD2XX_LIBRARIES - Link these to use libftdi
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if (NOT LIBFTD2XX_FOUND)
</I>&gt;<i> +
</I>&gt;<i> +    if(NOT WIN32)
</I>&gt;<i> +        include(FindPkgConfig)
</I>&gt;<i> +        pkg_check_modules(LIBFTD2XX_PKG libftd2xx)
</I>&gt;<i> +    endif(NOT WIN32)
</I>&gt;<i> +
</I>&gt;<i> +    find_path(LIBFTD2XX_INCLUDE_DIR
</I>&gt;<i> +        NAMES
</I>&gt;<i> +            ftd2xx.h
</I>&gt;<i> +        HINTS
</I>&gt;<i> +            ${LIBFTD2XX_PKG_INCLUDE_DIRS}
</I>&gt;<i> +        PATHS
</I>&gt;<i> +            /usr/include
</I>&gt;<i> +            /usr/local/include
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +    message(&quot;CMAKE_FIND_LIBRARY_SUFFIXES=\&quot;$ 
</I>&gt;<i> {CMAKE_FIND_LIBRARY_SUFFIXES}\&quot;&quot;)
</I>&gt;<i> +
</I>&gt;<i> +#    if(USE_STATIC_FT2232)
</I>&gt;<i> +#        set(_save ${CMAKE_FIND_LIBRARY_SUFFIXES})
</I>&gt;<i> +#        set(CMAKE_FIND_LIBRARY_SUFFIXES $ 
</I>&gt;<i> {CMAKE_STATIC_LIBRARY_SUFFIX})
</I>&gt;<i> +#    endif(USE_STATIC_FT2232)
</I>&gt;<i> +
</I>&gt;<i> +    find_library(LIBFTD2XX_LIBRARIES
</I>&gt;<i> +        NAMES
</I>&gt;<i> +            ftd2xx
</I>&gt;<i> +            ${LIBFTD2XX_PKG_LIBRARY_DIRS}
</I>&gt;<i> +        PATHS
</I>&gt;<i> +            /usr/lib
</I>&gt;<i> +            /usr/local/lib
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +#    if(USE_STATIC_FT2232)
</I>&gt;<i> +#        set(CMAKE_FIND_LIBRARY_SUFFIXES ${_save} )
</I>&gt;<i> +#    endif(USE_STATIC_FT2232)
</I>&gt;<i> +
</I>&gt;<i> +    include(FindPackageHandleStandardArgs)
</I>&gt;<i> +
</I>&gt;<i> +    # handle the QUIETLY AND REQUIRED arguments AND set  
</I>&gt;<i> LIBFTD2XX_FOUND to TRUE if
</I>&gt;<i> +    # all listed variables are TRUE
</I>&gt;<i> +    find_package_handle_standard_args(LIBFTD2XX DEFAULT_MSG  
</I>&gt;<i> LIBFTD2XX_LIBRARIES LIBFTD2XX_INCLUDE_DIR)
</I>&gt;<i> +
</I>&gt;<i> +#    if(USE_STATIC_FT2232)
</I>&gt;<i> +#        add_library(libftd2xx STATIC IMPORTED)
</I>&gt;<i> +#    else(USE_STATIC_FT2232)
</I>&gt;<i> +#        add_library(libftd2xx SHARED IMPORTED)
</I>&gt;<i> +#    endif(USE_STATIC_FT2232)
</I>&gt;<i> +
</I>&gt;<i> +#    set_target_properties(libftd2xx PROPERTIES IMPORTED_LOCATION $ 
</I>&gt;<i> {LIBFTD2XX_LIBRARIES})
</I>&gt;<i> +#    set(${LIBFTD2XX_LIBRARIES} libftd2xx)
</I>&gt;<i> +
</I>&gt;<i> +    #mark_as_advanced(LIBFTD2XX_INCLUDE_DIR LIBFTD2XX_LIBRARIES)
</I>&gt;<i> +
</I>&gt;<i> +endif(NOT LIBFTD2XX_FOUND)
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/CMakeModules/FindLibFTD2XX.cmake
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/CMakeModules/FindLibFTDI.cmake
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/CMakeModules/FindLibFTDI.cmake	(revision 0)
</I>&gt;<i> +++ src/CMakeModules/FindLibFTDI.cmake	(revision 0)
</I>&gt;<i> @@ -0,0 +1,69 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +#
</I>&gt;<i> +# - Try to find libftdi
</I>&gt;<i> +#
</I>&gt;<i> +# Before calling, USE_STATIC_FTDI may be set to mandate a STATIC  
</I>&gt;<i> library
</I>&gt;<i> +#
</I>&gt;<i> +# Once done this will define
</I>&gt;<i> +#
</I>&gt;<i> +# LIBFTDI_FOUND - system has libftdi
</I>&gt;<i> +# LIBFTDI_INCLUDE_DIR - the libftdi include directory
</I>&gt;<i> +# LIBFTDI_LIBRARIES - Link these to use libftdi
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if (NOT LIBFTDI_FOUND)
</I>&gt;<i> +
</I>&gt;<i> +    if(NOT WIN32)
</I>&gt;<i> +        include(FindPkgConfig)
</I>&gt;<i> +        pkg_check_modules(LIBFTDI_PKG libftdi)
</I>&gt;<i> +    endif(NOT WIN32)
</I>&gt;<i> +
</I>&gt;<i> +    find_path(LIBFTDI_INCLUDE_DIR
</I>&gt;<i> +        NAMES
</I>&gt;<i> +            ftdi.h
</I>&gt;<i> +        HINTS
</I>&gt;<i> +            ${LIBFTDI_PKG_INCLUDE_DIRS}
</I>&gt;<i> +        PATHS
</I>&gt;<i> +            /usr/include
</I>&gt;<i> +            /usr/local/include
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_FTDI)
</I>&gt;<i> +        set(_save ${CMAKE_FIND_LIBRARY_SUFFIXES})
</I>&gt;<i> +        set(CMAKE_FIND_LIBRARY_SUFFIXES $ 
</I>&gt;<i> {CMAKE_STATIC_LIBRARY_SUFFIX})
</I>&gt;<i> +    endif(USE_STATIC_FTDI)
</I>&gt;<i> +
</I>&gt;<i> +    find_library(LIBFTDI_LIBRARIES
</I>&gt;<i> +        NAMES
</I>&gt;<i> +            ftdi
</I>&gt;<i> +        HINTS
</I>&gt;<i> +            ${LIBFTDI_PKG_LIBRARY_DIRS}
</I>&gt;<i> +        PATHS
</I>&gt;<i> +            /usr/lib
</I>&gt;<i> +            /usr/local/lib
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_FTDI)
</I>&gt;<i> +        set(CMAKE_FIND_LIBRARY_SUFFIXES ${_save} )
</I>&gt;<i> +    endif(USE_STATIC_FTDI)
</I>&gt;<i> +
</I>&gt;<i> +    include(FindPackageHandleStandardArgs)
</I>&gt;<i> +
</I>&gt;<i> +    # handle the QUIETLY AND REQUIRED arguments AND set  
</I>&gt;<i> LIBFTDI_FOUND to TRUE if
</I>&gt;<i> +    # all listed variables are TRUE
</I>&gt;<i> +    find_package_handle_standard_args(LIBFTDI DEFAULT_MSG  
</I>&gt;<i> LIBFTDI_LIBRARIES LIBFTDI_INCLUDE_DIR)
</I>&gt;<i> +
</I>&gt;<i> +    if(USE_STATIC_FTDI)
</I>&gt;<i> +        add_library(libftdi STATIC IMPORTED)
</I>&gt;<i> +    else(USE_STATIC_FTDI)
</I>&gt;<i> +        add_library(libftdi SHARED IMPORTED)
</I>&gt;<i> +    endif(USE_STATIC_FTDI)
</I>&gt;<i> +
</I>&gt;<i> +    set_target_properties(libftdi PROPERTIES IMPORTED_LOCATION $ 
</I>&gt;<i> {LIBFTDI_LIBRARIES})
</I>&gt;<i> +    set(${LIBFTDI_LIBRARIES} libftdi)
</I>&gt;<i> +
</I>&gt;<i> +    #mark_as_advanced(LIBFTDI_INCLUDE_DIR LIBFTDI_LIBRARIES)
</I>&gt;<i> +
</I>&gt;<i> +endif(NOT LIBFTDI_FOUND)
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/CMakeModules/FindLibFTDI.cmake
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/config.h.cmake
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/config.h.cmake	(revision 0)
</I>&gt;<i> +++ src/config.h.cmake	(revision 0)
</I>&gt;<i> @@ -0,0 +1,197 @@
</I>&gt;<i> +/ 
</I>&gt;<i> ***************************************************************************
</I>&gt;<i> + *   Copyright (C) 2009 SoftPLC Corporation <A HREF="http://">http://</A> 
</I>&gt;<i> softplc.com             *
</I>&gt;<i> + *   Dick Hollenbeck  
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;                                    *
</I>&gt;<i> +  
</I>&gt;<i> *                                                                         *
</I>&gt;<i> + *   This program is free software; you can redistribute it and/or  
</I>&gt;<i> modify  *
</I>&gt;<i> + *   it under the terms of the GNU General Public License as  
</I>&gt;<i> published by  *
</I>&gt;<i> + *   the Free Software Foundation; either version 2 of the License,  
</I>&gt;<i> or     *
</I>&gt;<i> + *   (at your option) any later  
</I>&gt;<i> version.                                   *
</I>&gt;<i> +  
</I>&gt;<i> *                                                                         *
</I>&gt;<i> + *   This program is distributed in the hope that it will be  
</I>&gt;<i> useful,       *
</I>&gt;<i> + *   but WITHOUT ANY WARRANTY; without even the implied warranty  
</I>&gt;<i> of        *
</I>&gt;<i> + *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See  
</I>&gt;<i> the         *
</I>&gt;<i> + *   GNU General Public License for more  
</I>&gt;<i> details.                          *
</I>&gt;<i> +  
</I>&gt;<i> *                                                                         *
</I>&gt;<i> + *   You should have received a copy of the GNU General Public  
</I>&gt;<i> License     *
</I>&gt;<i> + *   along with this program; if not, write to  
</I>&gt;<i> the                         *
</I>&gt;<i> + *   Free Software Foundation,  
</I>&gt;<i> Inc.,                                       *
</I>&gt;<i> + *   59 Temple Place - Suite 330, Boston, MA  02111-1307,  
</I>&gt;<i> USA.             *
</I>&gt;<i> +  
</I>&gt;<i> ***************************************************************************/
</I>&gt;<i> +
</I>&gt;<i> +/* config.h is created by CMake during a preprocessing operation  
</I>&gt;<i> from config.h.cmake */
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the Amontec JTAG-Accelerator driver. */
</I>&gt;<i> +#cmakedefine BUILD_AMTJTAGACCEL	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the ARM-JTAG-EW JTAG driver. */
</I>&gt;<i> +#cmakedefine BUILD_ARMJTAGEW	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want at91rm9200. */
</I>&gt;<i> +#cmakedefine BUILD_AT91RM9200	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want a bitbang interface. */
</I>&gt;<i> +#cmakedefine BUILD_BITBANG	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want a bitq interface. */
</I>&gt;<i> +#cmakedefine BUILD_BITQ		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want dummy driver. */
</I>&gt;<i> +#cmakedefine BUILD_DUMMY		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want eCosBoard. */
</I>&gt;<i> +#cmakedefine BUILD_ECOSBOARD	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want ep93xx. */
</I>&gt;<i> +#cmakedefine BUILD_EP93XX	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want ftd2xx ft2232. */
</I>&gt;<i> +#cmakedefine BUILD_FT2232_FTD2XX		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want libftdi ft2232. */
</I>&gt;<i> +#cmakedefine BUILD_FT2232_LIBFTDI	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the Gateworks GW16012 driver. */
</I>&gt;<i> +#cmakedefine BUILD_GW16012	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want httpd. */
</I>&gt;<i> +#cmakedefine BUILD_HTTPD		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want ioutils. */
</I>&gt;<i> +#cmakedefine BUILD_IOUTIL	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the J-Link JTAG driver. */
</I>&gt;<i> +#cmakedefine BUILD_JLINK		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the OpenOCD+trace ETM capture driver. */
</I>&gt;<i> +#cmakedefine BUILD_OOCD_TRACE	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want parport. */
</I>&gt;<i> +#cmakedefine BUILD_PARPORT	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the ASIX PRESTO driver using FTD2XX. */
</I>&gt;<i> +#cmakedefine BUILD_PRESTO_FTD2XX	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the ASIX PRESTO driver using libftdi. */
</I>&gt;<i> +#cmakedefine BUILD_PRESTO_LIBFTDI	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the RLink JTAG driver. */
</I>&gt;<i> +#cmakedefine BUILD_RLINK		1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the usbprog JTAG driver. */
</I>&gt;<i> +#cmakedefine BUILD_USBPROG	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want the Versaloon-Link JTAG driver. */
</I>&gt;<i> +#cmakedefine BUILD_VSLLINK	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want parport to use giveio. */
</I>&gt;<i> +#cmakedefine PARPORT_USE_GIVEIO	1
</I>&gt;<i> +
</I>&gt;<i> +/* if you want parport to use ppdev. */
</I>&gt;<i> +#cmakedefine PARPORT_USE_PPDEV	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;elf.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_ELF_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the `gettimeofday' function. */
</I>&gt;<i> +#cmakedefine HAVE_GETTIMEOFDAY	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;inttypes.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_INTTYPES_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;jtag_minidriver.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_JTAG_MINIDRIVER_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;memory.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_MEMORY_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;stdbool.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_STDBOOL_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;stdint.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_STDINT_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;stdlib.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_STDLIB_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;strings.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_STRINGS_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;string.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_STRING_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the `strndup' function. */
</I>&gt;<i> +#cmakedefine HAVE_STRNDUP	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the `strnlen' function. */
</I>&gt;<i> +#cmakedefine HAVE_STRNLEN	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;sys/param.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_SYS_PARAM_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;sys/stat.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_SYS_STAT_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;sys/time.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_SYS_TIME_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;sys/types.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_SYS_TYPES_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the &lt;unistd.h&gt; header file. */
</I>&gt;<i> +#cmakedefine HAVE_UNISTD_H	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the `usleep' function. */
</I>&gt;<i> +#cmakedefine HAVE_USLEEP	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the `vasprintf' function. */
</I>&gt;<i> +#cmakedefine HAVE_VASPRINTF	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you have the ANSI C header files. */
</I>&gt;<i> +#cmakedefine STDC_HEADERS	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if you can safely include both &lt;sys/time.h&gt; and  
</I>&gt;<i> &lt;time.h&gt;. */
</I>&gt;<i> +#cmakedefine TIME_WITH_SYS_TIME	1
</I>&gt;<i> +
</I>&gt;<i> +/* Version number of package */
</I>&gt;<i> +#define VERSION	 	&quot;${VERSION}&quot;
</I>&gt;<i> +
</I>&gt;<i> +/* Define to 1 if your processor stores words with the most  
</I>&gt;<i> significant byte
</I>&gt;<i> +   first (like Motorola and SPARC, unlike Intel and VAX). */
</I>&gt;<i> +#cmakedefine WORDS_BIGENDIAN	1
</I>&gt;<i> +
</I>&gt;<i> +/* if not building for Cygwin. */
</I>&gt;<i> +#cmakedefine IS_CYGWIN	1
</I>&gt;<i> +
</I>&gt;<i> +/* 1 if building for MinGW. */
</I>&gt;<i> +#cmakedefine IS_MINGW	1
</I>&gt;<i> +
</I>&gt;<i> +/* if not building for Win32. */
</I>&gt;<i> +#cmakedefine IS_WIN32	1
</I>&gt;<i> +
</I>&gt;<i> +/* Name of package */
</I>&gt;<i> +#cmakedefine PACKAGE	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to the address where bug reports for this package should  
</I>&gt;<i> be sent. */
</I>&gt;<i> +#cmakedefine PACKAGE_BUGREPORT	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to the full name of this package. */
</I>&gt;<i> +#cmakedefine PACKAGE_NAME	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to the full name and version of this package. */
</I>&gt;<i> +#cmakedefine PACKAGE_STRING	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to the one symbol short name of this package. */
</I>&gt;<i> +#cmakedefine PACKAGE_TARNAME	1
</I>&gt;<i> +
</I>&gt;<i> +/* Define to the version of this package. */
</I>&gt;<i> +#cmakedefine PACKAGE_VERSION	1
</I>&gt;<i> +
</I>&gt;<i> +#define PKGLIBDIR	&quot;${PKGLIBDIR}&quot;
</I>&gt;<i> +
</I>&gt;<i> +#define PKGDATADIR	&quot;${PKGDATADIR}&quot;
</I>&gt;<i> +
</I>&gt;<i> +/* Define the subversion revision number, in double quotes */
</I>&gt;<i> +#define PKGBLDREV	&quot;${PKGBLDREV}&quot;
</I>&gt;<i> +
</I>&gt;<i> +/* A leading prompt for the version number, in double quotes */
</I>&gt;<i> +#define RELSTR		&quot;${RELSTR}&quot;
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/config.h.cmake
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i> Index: src/CMakeLists.txt
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/CMakeLists.txt	(revision 0)
</I>&gt;<i> +++ src/CMakeLists.txt	(revision 0)
</I>&gt;<i> @@ -0,0 +1,370 @@
</I>&gt;<i> +# Copyright 2009  SoftPLC Corporation  <A HREF="http://softplc.com">http://softplc.com</A>
</I>&gt;<i> +# Dick Hollenbeck &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">dick at softplc.com</A>&gt;
</I>&gt;<i> +# License: GPL v2
</I>&gt;<i> +
</I>&gt;<i> +# This is the top level CMake build script for OpenOCD.
</I>&gt;<i> +# First created: April 2009
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# <A HREF="http://www.vtk.org/Wiki/CMake_FAQ">http://www.vtk.org/Wiki/CMake_FAQ</A>
</I>&gt;<i> +# Read the above for information on CMake and in particular, &quot;Out  
</I>&gt;<i> of Tree Builds&quot;
</I>&gt;<i> +# I have a &lt;base&gt;/release and a &lt;base&gt;/debug directory, at same  
</I>&gt;<i> level as &lt;base&gt;/src.
</I>&gt;<i> +# $ cd release
</I>&gt;<i> +# cmake -DBUILD_&lt;what1&gt;=1  -DBUILD_&lt;what2&gt;=1  ../src
</I>&gt;<i> +# make
</I>&gt;<i> +# sudo make install
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +project(openocd C)
</I>&gt;<i> +
</I>&gt;<i> +cmake_minimum_required(VERSION 2.6.2 FATAL_ERROR)
</I>&gt;<i> +
</I>&gt;<i> +# Path to local CMake modules.
</I>&gt;<i> +set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/CMakeModules)
</I>&gt;<i> +
</I>&gt;<i> +set(VERSION 1.0)        # version of openocd that this is
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +###### Command line options  
</I>&gt;<i> #############################################
</I>&gt;<i> +
</I>&gt;<i> +# that enable OR disable features in the build.
</I>&gt;<i> +# For example, use -DBUILD_PARPORT=ON to enable parport support
</I>&gt;<i> +
</I>&gt;<i> +option(BUILD_PARPORT            &quot;Enable building the pc parallel  
</I>&gt;<i> port driver (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_DUMMY              &quot;Enable building the dummy port  
</I>&gt;<i> driver (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_PARPORT_PPDEV      &quot;Enable use of ppdev (/dev/ 
</I>&gt;<i> parportN) for parport (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_FT2232_FTD2XX      &quot;Enable building support for FT2232  
</I>&gt;<i> based devices using the FTD2XX driver from ftdichip.com (default  
</I>&gt;<i> OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_FT2232_LIBFTDI     &quot;Enable building support for FT2232  
</I>&gt;<i> based devices using the libftdi driver, opensource alternate of  
</I>&gt;<i> FTD2XX (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_AMTJTAGACCEL       &quot;Enable building the Amontec JTAG- 
</I>&gt;<i> Accelerator driver (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_ECOSBOARD          &quot;Enable building support for  
</I>&gt;<i> eCosBoard based JTAG debugger (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_IOUTIL             &quot;Enable ioutil functions - useful  
</I>&gt;<i> for standalone OpenOCD implementations (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_HTTPD              &quot;Enable builtin httpd server -  
</I>&gt;<i> useful for standalone OpenOCD implementations (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_EP93XX             &quot;Enable building support for EP93xx  
</I>&gt;<i> based SBCs (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_AT91RM9200         &quot;Enable building support for  
</I>&gt;<i> AT91RM9200 based SBCs (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_GW16012            &quot;Enable building support for the  
</I>&gt;<i> Gateworks GW16012 JTAG Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +
</I>&gt;<i> +#option(BUILD_PRESTO_LIBFTDI    &quot;Enable building support for ASIX  
</I>&gt;<i> Presto Programmer using the libftdi driver (default OFF)&quot; OFF)
</I>&gt;<i> +#option(BUILD_PRESTO_FTD2XX     &quot;Enable building support for ASIX  
</I>&gt;<i> Presto Programmer using the FTD2XX driver (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_PRESTO             &quot;Enable building support for ASIX  
</I>&gt;<i> Presto Programmer using the selected FT2232 driver (default OFF)&quot; OFF)
</I>&gt;<i> +
</I>&gt;<i> +option(BUILD_USBPROG            &quot;Enable building support for the  
</I>&gt;<i> usbprog JTAG Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_OOCD_TRACE         &quot;Enable building support for the  
</I>&gt;<i> OpenOCD+trace ETM capture device (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_JLINK              &quot;Enable building support for the  
</I>&gt;<i> Segger J-Link JTAG Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_VSLLINK            &quot;Enable building support for the  
</I>&gt;<i> Versaloon-Link JTAG Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_RLINK              &quot;Enable building support for the  
</I>&gt;<i> Raisonance RLink JTAG Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_ARM_JTAG_EW        &quot;Enable building support for the  
</I>&gt;<i> Olimex ARM-JTAG-EW Programmer (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_PARPORT_GIVEIO     &quot;Enable use of giveio for parport  
</I>&gt;<i> instead of ioperm (default OFF)&quot; OFF)
</I>&gt;<i> +option(BUILD_BITQ               &quot;Enable a BITQ interface (default  
</I>&gt;<i> ON)&quot; ON)
</I>&gt;<i> +
</I>&gt;<i> +option(USE_STATIC_USB           &quot;If ON use a static libusb, else  
</I>&gt;<i> dynamic (default OFF = dynamic)&quot; OFF)
</I>&gt;<i> +
</I>&gt;<i> +# this option must be used along with BUILD_FT2232_LIBFTDI
</I>&gt;<i> +option(USE_STATIC_FTDI          &quot;If ON use a static libftdi, else  
</I>&gt;<i> dynamic (default OFF = dynamic)&quot; OFF)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# this one wanted to be special
</I>&gt;<i> +if(BUILD_PRESTO)
</I>&gt;<i> +    if( NOT BUILD_FT2232_FTD2XX AND NOT BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +        message( FATAL_ERROR &quot;You must specify either - 
</I>&gt;<i> DBUILD_FT2232_FTD2XX=1 or -DBUILD_FT2232_LIBFTDI=1 when building  
</I>&gt;<i> PRESTO&quot;)
</I>&gt;<i> +    endif( NOT BUILD_FT2232_FTD2XX AND NOT BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +    if(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +        set( BUILD_PRESTO_FTD2XX ON)
</I>&gt;<i> +    endif(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +    if(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +        set( BUILD_PRESTO_LIBFTDI ON)
</I>&gt;<i> +    endif(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +endif(BUILD_PRESTO)
</I>&gt;<i> +#message(&quot;BUILD_PRESTO=\&quot;${BUILD_PRESTO}\&quot; BUILD_PRESTO_FTD2XX=\&quot;$ 
</I>&gt;<i> {BUILD_PRESTO_FTD2XX}\&quot; BUILD_PRESTO_LIBFTDI=\&quot;$ 
</I>&gt;<i> {BUILD_PRESTO_LIBFTDI}\&quot;&quot;)
</I>&gt;<i> +#message(&quot;BUILD_FT2232_FTD2XX=\&quot;${BUILD_FT2232_FTD2XX}\&quot;  
</I>&gt;<i> BUILD_FT2232_LIBFTDI=\&quot;${BUILD_FT2232_LIBFTDI}\&quot;&quot;)
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_HTTPD)
</I>&gt;<i> +    # httpd.c needs function loadFile() in ioutil.c
</I>&gt;<i> +    set(BUILD_IOUTIL ON)
</I>&gt;<i> +endif(BUILD_HTTPD)
</I>&gt;<i> +
</I>&gt;<i> +# Having these here seems to keep the find modules from finding  
</I>&gt;<i> standard installations of these libraries,
</I>&gt;<i> +# so these are commented out for now
</I>&gt;<i> +#set( LIBFTD2XX_LIBRARIES    &quot;&quot; CACHE PATH &quot;Path to the ftd2xx  
</I>&gt;<i> library&quot;)
</I>&gt;<i> +#set( LIBFTD2XX_INCLUDE_DIR  &quot;&quot; CACHE PATH &quot;Path to the ftd2xx  
</I>&gt;<i> header files&quot;)
</I>&gt;<i> +#set( LIBFTDI_LIBRARIES      &quot;&quot; CACHE PATH &quot;Path to the ftdi  
</I>&gt;<i> library&quot;)
</I>&gt;<i> +#set( LIBFTDI_INCLUDE_DIR    &quot;&quot; CACHE PATH &quot;Path to the ftdi header  
</I>&gt;<i> files&quot;)
</I>&gt;<i> +#set( LIBUSB_LIBRARIES       &quot;&quot; CACHE PATH &quot;Path to the usb library&quot;)
</I>&gt;<i> +#set( LIBUSB_INCLUDE_DIR     &quot;&quot; CACHE PATH &quot;Path to the usb header  
</I>&gt;<i> files&quot;)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# Locations for install targets.
</I>&gt;<i> +set(OPENOCD_BIN bin CACHE PATH &quot;Location of OpenOCD binaries,  
</I>&gt;<i> relative to CMAKE_INSTALL_PREFIX if not absolute path.&quot;)
</I>&gt;<i> +
</I>&gt;<i> +if(UNIX)
</I>&gt;<i> +    # Like all variables, CMAKE_INSTALL_PREFIX can be over-ridden  
</I>&gt;<i> on the command line.
</I>&gt;<i> +    set(CMAKE_INSTALL_PREFIX /usr/local CACHE PATH &quot;&quot;)
</I>&gt;<i> +
</I>&gt;<i> +    # Everything without leading / is relative to  
</I>&gt;<i> CMAKE_INSTALL_PREFIX.
</I>&gt;<i> +    set(OPENOCD_DATA share/openocd      CACHE PATH &quot;Location of  
</I>&gt;<i> OpenOCD data files, relative to CMAKE_INSTALL_PREFIX if not absolute  
</I>&gt;<i> path.&quot;)
</I>&gt;<i> +    set(OPENOCD_DOCS share/doc/openocd  CACHE PATH &quot;Location of  
</I>&gt;<i> OpenOCD documentation files, relative to CMAKE_INSTALL_PREFIX if not  
</I>&gt;<i> absolute path.&quot;)
</I>&gt;<i> +    set(OPENOCD_LIBS lib/openocd        CACHE PATH &quot;Location of  
</I>&gt;<i> OpenOCD libary file, relative to CMAKE_INSTALL_PREFIX if not  
</I>&gt;<i> absolute path.&quot;)
</I>&gt;<i> +endif(UNIX)
</I>&gt;<i> +
</I>&gt;<i> +if(WIN32)
</I>&gt;<i> +    # Like all variables, CMAKE_INSTALL_PREFIX can be over-ridden  
</I>&gt;<i> on the command line.
</I>&gt;<i> +    set(CMAKE_INSTALL_PREFIX c:/OpenOCD CACHE PATH &quot;&quot;)
</I>&gt;<i> +
</I>&gt;<i> +    # Everything without leading / is relative to  
</I>&gt;<i> CMAKE_INSTALL_PREFIX.
</I>&gt;<i> +    set(OPENOCD_DATA share CACHE PATH &quot;Location of OpenOCD data  
</I>&gt;<i> files, relative to CMAKE_INSTALL_PREFIX if not absolute path.&quot;)
</I>&gt;<i> +    set(OPENOCD_DOCS doc   CACHE PATH &quot;Location of OpenOCD  
</I>&gt;<i> documentation files, relative to CMAKE_INSTALL_PREFIX if not  
</I>&gt;<i> absolute path.&quot;)
</I>&gt;<i> +    set(OPENOCD_LIBS lib   CACHE PATH &quot;Location of OpenOCD libary  
</I>&gt;<i> file, relative to CMAKE_INSTALL_PREFIX if not absolute path.&quot;)
</I>&gt;<i> +endif(WIN32)
</I>&gt;<i> +
</I>&gt;<i> +# set the PKGDATADIR and PKGLIBDIR the same way the install()  
</I>&gt;<i> function creates
</I>&gt;<i> +# the intallation path from CMAKE_INSTALL_PREFIX and OPENOCD_DATA or
</I>&gt;<i> +# OPENOCD_LIBS respectively.  PKGLIBDIR and PKGDATADIR are passed  
</I>&gt;<i> into the *.c code
</I>&gt;<i> +# via the config.h file, whereas OPENOCD_DATA and OPENOCD_LIBS are  
</I>&gt;<i> given to the
</I>&gt;<i> +# install() function.  After install() works on its arguments, it  
</I>&gt;<i> should come up
</I>&gt;<i> +# with the same as our PKGDATADIR and PKGLIBDIR.
</I>&gt;<i> +if( IS_ABSOLUTE ${OPENOCD_DATA} )
</I>&gt;<i> +    set(PKGDATADIR ${OPENOCD_DATA})
</I>&gt;<i> +else( IS_ABSOLUTE ${OPENOCD_DATA} )
</I>&gt;<i> +    set(PKGDATADIR ${CMAKE_INSTALL_PREFIX}/${OPENOCD_DATA})
</I>&gt;<i> +endif( IS_ABSOLUTE ${OPENOCD_DATA} )
</I>&gt;<i> +
</I>&gt;<i> +if( IS_ABSOLUTE ${OPENOCD_LIBS} )
</I>&gt;<i> +    set(PKGLIBDIR ${OPENOCD_LIBS})
</I>&gt;<i> +else( IS_ABSOLUTE ${OPENOCD_LIBS} )
</I>&gt;<i> +    set(PKGLIBDIR ${CMAKE_INSTALL_PREFIX}/${OPENOCD_LIBS})
</I>&gt;<i> +endif( IS_ABSOLUTE ${OPENOCD_LIBS} )
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# check for include files and functions
</I>&gt;<i> +include(CheckIncludeFile)
</I>&gt;<i> +check_include_file(elf.h HAVE_ELF_H)
</I>&gt;<i> +check_include_file(inttypes.h HAVE_INTTYPES_H)
</I>&gt;<i> +check_include_file(jtag_minidriver.h HAVE_JTAG_MINIDRIVER_H)
</I>&gt;<i> +check_include_file(memory.h HAVE_MEMORY_H)
</I>&gt;<i> +check_include_file(stdbool.h HAVE_STDBOOL_H)
</I>&gt;<i> +check_include_file(stdint.h HAVE_STDINT_H)
</I>&gt;<i> +check_include_file(stdlib.h HAVE_STDLIB_H)
</I>&gt;<i> +check_include_file(strings.h HAVE_STRINGS_H)
</I>&gt;<i> +check_include_file(string.h HAVE_STRING_H)
</I>&gt;<i> +check_include_file(sys/param.h HAVE_SYS_PARAM_H)
</I>&gt;<i> +check_include_file(sys/stat.h HAVE_SYS_STAT_H)
</I>&gt;<i> +check_include_file(sys/time.h HAVE_SYS_TIME_H)
</I>&gt;<i> +check_include_file(sys/types.h HAVE_SYS_TYPES_H)
</I>&gt;<i> +check_include_file(unistd.h HAVE_UNISTD_H)
</I>&gt;<i> +
</I>&gt;<i> +include(CheckFunctionExists)
</I>&gt;<i> +check_function_exists(gettimeofday HAVE_GETTIMEOFDAY)
</I>&gt;<i> +check_function_exists(strnlen HAVE_STRNLEN)
</I>&gt;<i> +check_function_exists(usleep HAVE_USLEEP)
</I>&gt;<i> +check_function_exists(vasprintf HAVE_VASPRINTF)
</I>&gt;<i> +
</I>&gt;<i> +include(CheckLibraryExists)
</I>&gt;<i> +check_library_exists(dl dlopen &quot;&quot; HAVE_LIBDL)
</I>&gt;<i> +
</I>&gt;<i> +#================================================
</I>&gt;<i> +# Set flags for GCC.
</I>&gt;<i> +#================================================
</I>&gt;<i> +
</I>&gt;<i> +if(CMAKE_COMPILER_IS_GNUC)
</I>&gt;<i> +    # Set default flags for Release build.
</I>&gt;<i> +    set(CMAKE_C_FLAGS_RELEASE &quot;-Wall -O2 -DNDEBUG&quot;)
</I>&gt;<i> +    set(CMAKE_CXX_FLAGS_RELEASE &quot;-Wall -O2 -DNDEBUG&quot;)
</I>&gt;<i> +    set(CMAKE_EXE_LINKER_FLAGS_RELEASE &quot;-s&quot;)
</I>&gt;<i> +
</I>&gt;<i> +    # Set default flags for Debug build.
</I>&gt;<i> +    set(CMAKE_C_FLAGS_DEBUG &quot;-Wall -g3 -ggdb3 -DDEBUG&quot;)
</I>&gt;<i> +    set(CMAKE_CXX_FLAGS_DEBUG &quot;-Wall -g3 -ggdb3 -DDEBUG&quot;)
</I>&gt;<i> +endif(CMAKE_COMPILER_IS_GNUC)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# CONDITIONAL_LIBS is added to other unconditional libs below
</I>&gt;<i> +set( CONDITIONAL_LIBS )
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +set(NEED_USB FALSE)
</I>&gt;<i> +if( BUILD_PRESTO OR BUILD_JLINK OR BUILD_RLINK OR BUILD_VSLINK OR  
</I>&gt;<i> BUILD_USBPROG OR USE_STATIC_FTDI)
</I>&gt;<i> +    #message(&quot;Yes USB&quot;)
</I>&gt;<i> +    set(NEED_USB TRUE)
</I>&gt;<i> +endif( BUILD_PRESTO OR BUILD_JLINK OR BUILD_RLINK OR BUILD_VSLINK  
</I>&gt;<i> OR BUILD_USBPROG OR USE_STATIC_FTDI)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(NEED_USB)
</I>&gt;<i> +    find_package(LibUSB)
</I>&gt;<i> +    #message(&quot;LIBUSB_LIBRARIES=\&quot;${LIBUSB_LIBRARIES}\&quot;&quot;)
</I>&gt;<i> +    set(CONDITIONAL_LIBS ${CONDITIONAL_LIBS} ${LIBUSB_LIBRARIES})
</I>&gt;<i> +    include_directories( ${LIBUSB_INCLUDE_DIR} )
</I>&gt;<i> +endif(NEED_USB)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +    #message(&quot;BUILD_FT2232_LIBFTDI=\&quot;${BUILD_FT2232_LIBFTDI}\&quot;&quot;)
</I>&gt;<i> +    if(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +        message( FATAL_ERROR &quot;BUILD_FT2232_FTD2XX and  
</I>&gt;<i> BUILD_FT2232_LIBFTDI are mutually exclusive, please enable only one&quot;)
</I>&gt;<i> +    endif(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +    find_package(LibFTD2XX)
</I>&gt;<i> +    #message(&quot;LIBFTD2XX_LIBRARIES=\&quot;${LIBFTD2XX_LIBRARIES}\&quot;&quot;)
</I>&gt;<i> +    set(CONDITIONAL_LIBS ${LIBFTD2XX_LIBRARIES})
</I>&gt;<i> +    include_directories( ${LIBFTD2XX_INCLUDE_DIR} )
</I>&gt;<i> +endif(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +    if(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +        message( FATAL_ERROR &quot;BUILD_FT2232_FTD2XX and  
</I>&gt;<i> BUILD_FT2232_LIBFTDI are mutually exclusive, please enable only one&quot;)
</I>&gt;<i> +    endif(BUILD_FT2232_FTD2XX)
</I>&gt;<i> +    find_package(LibFTDI)
</I>&gt;<i> +    #message(&quot;LIBFTDI_LIBRARIES=\&quot;${LIBFTDI_LIBRARIES}\&quot;&quot;)
</I>&gt;<i> +    set(CONDITIONAL_LIBS ${LIBFTDI_LIBRARIES} ${CONDITIONAL_LIBS})
</I>&gt;<i> +    include_directories( ${LIBFTDI_INCLUDE_DIR} )
</I>&gt;<i> +endif(BUILD_FT2232_LIBFTDI)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(BUILD_HTTPD)
</I>&gt;<i> +    #future:
</I>&gt;<i> +    #find_package(LibMicroHTTPD)
</I>&gt;<i> +    # use this for now:
</I>&gt;<i> +
</I>&gt;<i> +    check_library_exists(microhttpd MHD_stop_daemon &quot;/usr/lib&quot;  
</I>&gt;<i> HAVE_LIBMICROHTTPD)
</I>&gt;<i> +    if(HAVE_LIBMICROHTTPD)
</I>&gt;<i> +        message(&quot;-- found libmicrohttpd&quot;)
</I>&gt;<i> +        set(CONDITIONAL_LIBS microhttpd ${CONDITIONAL_LIBS})
</I>&gt;<i> +    endif(HAVE_LIBMICROHTTPD)
</I>&gt;<i> +
</I>&gt;<i> +endif(BUILD_HTTPD)
</I>&gt;<i> +
</I>&gt;<i> +if(HAVE_LIBDL)
</I>&gt;<i> +    set(CONDITIONAL_LIBS ${CONDITIONAL_LIBS} dl)
</I>&gt;<i> +endif(HAVE_LIBDL)
</I>&gt;<i> +
</I>&gt;<i> +include(TestBigEndian)
</I>&gt;<i> +test_big_endian( WORDS_BIGENDIAN )
</I>&gt;<i> +
</I>&gt;<i> +if(RELEASE)
</I>&gt;<i> +    set(RELSTR Release)
</I>&gt;<i> +    set(PKGBLDREV &quot;&quot;)
</I>&gt;<i> +else(RELEASE)
</I>&gt;<i> +    set(RELSTR svn:)
</I>&gt;<i> +    find_package(Subversion)
</I>&gt;<i> +    if(Subversion_FOUND)
</I>&gt;<i> +        subversion_wc_info( ${PROJECT_SOURCE_DIR} OPENOCD )
</I>&gt;<i> +        MESSAGE(&quot;Current revision is ${OPENOCD_WC_REVISION}&quot;)
</I>&gt;<i> +        set(PKGBLDREV ${OPENOCD_WC_REVISION})
</I>&gt;<i> +    else(Subversion_FOUND)
</I>&gt;<i> +        set(PKGBLDREV &quot;&quot;)
</I>&gt;<i> +    endif(Subversion_FOUND)
</I>&gt;<i> +endif(RELEASE)
</I>&gt;<i> +
</I>&gt;<i> +# preprocess and output config.h into release or debug directory
</I>&gt;<i> +configure_file(${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake $ 
</I>&gt;<i> {CMAKE_CURRENT_BINARY_DIR}/config.h)
</I>&gt;<i> +
</I>&gt;<i> +include_directories(
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/target
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/server
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/helper
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/jtag
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/xsvf
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/svf
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/flash
</I>&gt;<i> +    ${CMAKE_CURRENT_SOURCE_DIR}/pld
</I>&gt;<i> +    ${CMAKE_BINARY_DIR}
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +if(NOT CMAKE_HOST_UNIX)
</I>&gt;<i> +    set(IS_WIN32, true)
</I>&gt;<i> +    # <A HREF="http://dev-notes.com/code.php?q=49">http://dev-notes.com/code.php?q=49</A>
</I>&gt;<i> +    set(GETDATECMD \\&quot;%date%\\&quot; )
</I>&gt;<i> +    #message(&quot;yes WIN32&quot;)
</I>&gt;<i> +else(NOT CMAKE_HOST_UNIX)
</I>&gt;<i> +    set(IS_WIN32, false)
</I>&gt;<i> +    set(GETDATECMD \\&quot;`date +%F-%R`\\&quot;)
</I>&gt;<i> +    #message(&quot;not WIN32&quot;)
</I>&gt;<i> +endif(NOT CMAKE_HOST_UNIX)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +if(CYGWIN)
</I>&gt;<i> +    set(IS_CYGWIN, true)
</I>&gt;<i> +else(CYGWIN)
</I>&gt;<i> +    set(IS_CYGWIN, false)
</I>&gt;<i> +endif(CYGWIN)
</I>&gt;<i> +
</I>&gt;<i> +if(MINGW)
</I>&gt;<i> +    set(IS_MINGW, true)
</I>&gt;<i> +else(MINGW)
</I>&gt;<i> +    set(IS_MINGW, false)
</I>&gt;<i> +endif(MINGW)
</I>&gt;<i> +
</I>&gt;<i> +add_definitions(
</I>&gt;<i> +    -DHAVE_CONFIG_H=1
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +add_subdirectory(helper)
</I>&gt;<i> +add_subdirectory(jtag)
</I>&gt;<i> +add_subdirectory(xsvf)
</I>&gt;<i> +add_subdirectory(svf)
</I>&gt;<i> +add_subdirectory(target)
</I>&gt;<i> +add_subdirectory(server)
</I>&gt;<i> +add_subdirectory(flash)
</I>&gt;<i> +add_subdirectory(pld)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +########### openocd target ###############
</I>&gt;<i> +
</I>&gt;<i> +set_source_files_properties( openocd.c PROPERTIES
</I>&gt;<i> +    COMPILE_FLAGS
</I>&gt;<i> +        -DPKGBLDDATE=${GETDATECMD}
</I>&gt;<i> +)
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +# create OPENOCD_SRCS
</I>&gt;<i> +# prepend the main file to OPENOCD_SRCS
</I>&gt;<i> +if(BUILD_ECOSBOARD)
</I>&gt;<i> +    set(OPENOCD_SRCS ecosboard.c openocd.c)
</I>&gt;<i> +else(BUILD_ECOSBOARD)
</I>&gt;<i> +    set(OPENOCD_SRCS main.c openocd.c)
</I>&gt;<i> +endif(BUILD_ECOSBOARD)
</I>&gt;<i> +
</I>&gt;<i> +add_executable(openocd ${OPENOCD_SRCS})
</I>&gt;<i> +
</I>&gt;<i> +target_link_libraries(openocd
</I>&gt;<i> +    xsvf
</I>&gt;<i> +    svf
</I>&gt;<i> +    target
</I>&gt;<i> +    jtag
</I>&gt;<i> +    server
</I>&gt;<i> +    flash
</I>&gt;<i> +    target
</I>&gt;<i> +    pld
</I>&gt;<i> +    helper
</I>&gt;<i> +    ${CONDITIONAL_LIBS}
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +########### install files ###############
</I>&gt;<i> +
</I>&gt;<i> +install(TARGETS openocd DESTINATION ${OPENOCD_BIN})
</I>&gt;<i> +
</I>&gt;<i> +install(
</I>&gt;<i> +    DIRECTORY   tcl
</I>&gt;<i> +    DESTINATION ${OPENOCD_LIBS}
</I>&gt;<i> +    COMPONENT   &quot;tcl configuration files&quot;
</I>&gt;<i> +    FILES_MATCHING PATTERN &quot;*.tcl&quot;
</I>&gt;<i> +    PATTERN      &quot;.svn&quot; EXCLUDE
</I>&gt;<i> +    )
</I>&gt;<i> +
</I>&gt;<i> +#   tcl/bitsbytes.tcl
</I>&gt;<i> +#   tcl/memory.tcl
</I>&gt;<i> +#   tcl/mmr_helpers.tcl
</I>&gt;<i> +#   tcl/readable.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/aic.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/at91sam7x128.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/at91sam7x256.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/pmc.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/rtt.tcl
</I>&gt;<i> +#   tcl/chip/atmel/at91/usarts.tcl
</I>&gt;<i> +#   tcl/chip/st/stm32/stm32.tcl
</I>&gt;<i> +#   tcl/chip/st/stm32/stm32_rcc.tcl
</I>&gt;<i> +#   tcl/chip/st/stm32/stm32_regs.tcl
</I>&gt;<i> +#   tcl/cpu/arm/arm7tdmi.tcl
</I>&gt;<i> +#   tcl/cpu/arm/arm920.tcl
</I>&gt;<i> +#   tcl/cpu/arm/arm946.tcl
</I>&gt;<i> +#   tcl/cpu/arm/arm966.tcl
</I>&gt;<i> +#   tcl/cpu/arm/cortex_m3.tcl
</I>&gt;<i>
</I>&gt;<i> Property changes on: src/CMakeLists.txt
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:mime-type
</I>&gt;<i>   + text/plain
</I>&gt;<i> Added: svn:eol-style
</I>&gt;<i>   + native
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Property changes on: tools/xsvf_tools/xsvfdump.py
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:executable
</I>&gt;<i>   + *
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Property changes on: tools/xsvf_tools/svf2xsvf.py
</I>&gt;<i> ___________________________________________________________________
</I>&gt;<i> Added: svn:executable
</I>&gt;<i>   + *
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Openocd-development mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">Openocd-development at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">https://lists.berlios.de/mailman/listinfo/openocd-development</A>
</I>
--
Rick Altherr
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">kc8apf at kc8apf.net</A>

&quot;He said he hadn't had a byte in three days. I had a short, so I split  
it with him.&quot;
  -- Unsigned



-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2446 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20090416/0f9310b9/attachment.bin">https://lists.berlios.de/pipermail/openocd-development/attachments/20090416/0f9310b9/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005360.html">[Openocd-development] [PATCH] CMake scripts
</A></li>
	<LI>Next message: <A HREF="005362.html">[Openocd-development] [PATCH] CMake scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5361">[ date ]</a>
              <a href="thread.html#5361">[ thread ]</a>
              <a href="subject.html#5361">[ subject ]</a>
              <a href="author.html#5361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
