<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] SWJ support, tested ok on STM32
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-October/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20SWJ%20support%2C%20tested%20ok%20on%20STM32&In-Reply-To=%3C63034c040910231805q1e95facaj8bd5d3640e41a65d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011776.html">
   <LINK REL="Next"  HREF="011596.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] SWJ support, tested ok on STM32</H1>
    <B>simon qian</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20SWJ%20support%2C%20tested%20ok%20on%20STM32&In-Reply-To=%3C63034c040910231805q1e95facaj8bd5d3640e41a65d%40mail.gmail.com%3E"
       TITLE="[Openocd-development] SWJ support, tested ok on STM32">simonqian.openocd at gmail.com
       </A><BR>
    <I>Sat Oct 24 03:05:21 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="011776.html">[Openocd-development] patch - added support for Signalyzer H2	and Signalyzer H4 JTAG dongles
</A></li>
        <LI>Next message: <A HREF="011596.html">[Openocd-development] SWJ support, tested ok on STM32
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11522">[ date ]</a>
              <a href="thread.html#11522">[ thread ]</a>
              <a href="subject.html#11522">[ subject ]</a>
              <a href="author.html#11522">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have tested the SWJ support to STM32, implemented in vsprog.

I'll then prepare to implement it in OpenOCD.
Most operation is the same as JTAG, but DP accesses are not posted.

For multiple interface, I'll add a &quot;swd_mode&quot; command to select SWD
interface.
Add corresponding SWD driver.
I find a patch about SWD support, but there is some BUG in the SWD
implementation in that patch.

SWJ interfaces functions:
SWJ_SeqOut: used to output a sequence, eg: output JTAG_TO_SWD sequence
SWJ_Transact: do the SWD RW operation
SWJ interfaces parameters:
SWJ_Trn: turnaround cycles, for STM32, default is 2
SWJ_Dly: delay in us for each bit

Below is the vsprog log when programming STM32 through SWD:

VSProg debug version (Oct 22 2009) MSVC express 2008 SP1:0000
CopyRight(c) 2008-2009 by SimonQian
URL: <A HREF="http://www.SimonQian.com/en/Versaloon&lt;http://www.simonqian.com/en/Versaloon">http://www.SimonQian.com/en/Versaloon&lt;http://www.simonqian.com/en/Versaloon</A>&gt;
mail: __N/A__
Info:   Versaloon(0x13)by Simon(compiled on Oct 24 2009)
Warning:5 is invalid for hex type, current line ignored!!
Info:   VSLLink_20080905 by Simon(compiled on Oct 24 2009)
Info:   SWJ_ID read is 0x1BA01477.         &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;++++++++++ SWJ_ID
++++++++++&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
Info:   AHB-AP_ID: 0x14770011
Info:   ROM_ADDRESS: 0xE00FF003
Info:   CFG: 0x00000000, Small-endian
Info:   CORTEX-M3 processor detected
Info:   CPUID: 0x411FC231
Info:   STM32 MCU_ID: 0x20016410
Info:   STM32 revision: Z
Info:   STM32 type: medium-density device
Info:   STM32 flash_size: 32K Bytes
Info:   STM32 sram_size: 6K Bytes
Info:   Target halted.
Info:   erasing chip
erasing chip |========================================%100| 0.03s used
Info:   chip erased
Info:   Target halted.
Info:   programming flash_loader
writing flash_loader |========================================%100| 0.00s
used
Info:   flash_loader programmed for 120bytes
Info:   verifying flash_loader
reading flash_loader |========================================%100| 0.00s
used
Info:   flash_loader verified for 120bytes
Info:   Target running.
Info:   programming flash
writing flash |========================================%100| 0.52s used
Info:   flash programmed for 15456bytes
Info:   verifying flash
reading flash |========================================%100| 0.36s used
Info:   flash verified for 15456bytes

-- 
Best Regards, SimonQian
<A HREF="http://www.SimonQian.com">http://www.SimonQian.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20091024/3b04d2d6/attachment.html">https://lists.berlios.de/pipermail/openocd-development/attachments/20091024/3b04d2d6/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011776.html">[Openocd-development] patch - added support for Signalyzer H2	and Signalyzer H4 JTAG dongles
</A></li>
	<LI>Next message: <A HREF="011596.html">[Openocd-development] SWJ support, tested ok on STM32
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11522">[ date ]</a>
              <a href="thread.html#11522">[ thread ]</a>
              <a href="subject.html#11522">[ subject ]</a>
              <a href="author.html#11522">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
