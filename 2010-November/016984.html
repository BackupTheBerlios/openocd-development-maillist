<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] [Patch] New JIMTCL
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2010-November/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPatch%5D%20New%20JIMTCL&In-Reply-To=%3CAANLkTi%3D%3DgaGd_vvpc9xxVgK%2B3-CA7NytMWXGkD531tTY%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017314.html">
   <LINK REL="Next"  HREF="016985.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] [Patch] New JIMTCL</H1>
    <B>Antonio Borneo</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPatch%5D%20New%20JIMTCL&In-Reply-To=%3CAANLkTi%3D%3DgaGd_vvpc9xxVgK%2B3-CA7NytMWXGkD531tTY%40mail.gmail.com%3E"
       TITLE="[Openocd-development] [Patch] New JIMTCL">borneo.antonio at gmail.com
       </A><BR>
    <I>Mon Nov  8 10:46:35 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="017314.html">[Openocd-development] Automatic detection of debugbase for	cortex A8
</A></li>
        <LI>Next message: <A HREF="016985.html">[Openocd-development] [Patch] New JIMTCL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16984">[ date ]</a>
              <a href="thread.html#16984">[ thread ]</a>
              <a href="subject.html#16984">[ subject ]</a>
              <a href="author.html#16984">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

after the replacement of JIMTCL with the new version, the command
&quot;puts&quot; does not work as before.
It prints nothing in the telnet connection, while is still working in
the default console.
Looking at the code, the reason is that the new jimtcl only prints to stdout.
Of course, it's possible to modify jimtcl library, but the
modification is quite invasive, and we would diverge from the main
branch.

The solution I propose, is to switch away from &quot;puts&quot;, in favour of &quot;echo&quot;.
The advantage is that &quot;echo&quot; is part of OpenOCD, so no change is
required inside jimtcl.

1) the first patch in attachment enhances &quot;echo&quot; with the command
option &quot;-n&quot;, to replace &quot;puts -nonewline&quot;

2) this patch can be eventually skipped. Anyway, I would like your
comments on it.
In order to add help text to &quot;echo&quot; command, I have replaced the
definition of the command inside the COMMAND_HANDLER syntax.
Is this correct? In my tests it works properly. I do not know if there
is any drawback.

3) this last patch replaces all the &quot;puts&quot; in the tcl files with &quot;echo&quot;

Best Regards,
Antonio Borneo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-JIM-Add-n-option-to-echo.patch
Type: application/octet-stream
Size: 1167 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment.obj">https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-JIM-document-echo-command.patch
Type: application/octet-stream
Size: 2724 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment-0001.obj">https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment-0001.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0003-TCL-scripts-replace-puts-with-echo.patch.gz
Type: application/x-gzip
Size: 10211 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment.bin">https://lists.berlios.de/pipermail/openocd-development/attachments/20101108/568ee1b4/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017314.html">[Openocd-development] Automatic detection of debugbase for	cortex A8
</A></li>
	<LI>Next message: <A HREF="016985.html">[Openocd-development] [Patch] New JIMTCL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16984">[ date ]</a>
              <a href="thread.html#16984">[ thread ]</a>
              <a href="subject.html#16984">[ subject ]</a>
              <a href="author.html#16984">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
