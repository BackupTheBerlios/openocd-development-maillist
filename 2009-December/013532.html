<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] OpenOCD broken
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-December/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20OpenOCD%20broken&In-Reply-To=%3C20091213214412.GG1819%40mail.wantstofly.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013531.html">
   <LINK REL="Next"  HREF="013534.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] OpenOCD broken</H1>
    <B>Lennert Buytenhek</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20OpenOCD%20broken&In-Reply-To=%3C20091213214412.GG1819%40mail.wantstofly.org%3E"
       TITLE="[Openocd-development] OpenOCD broken">buytenh at wantstofly.org
       </A><BR>
    <I>Sun Dec 13 22:44:12 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="013531.html">[Openocd-development] OpenOCD broken
</A></li>
        <LI>Next message: <A HREF="013534.html">[Openocd-development] OpenOCD [not] broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13532">[ date ]</a>
              <a href="thread.html#13532">[ thread ]</a>
              <a href="subject.html#13532">[ subject ]</a>
              <a href="author.html#13532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Dec 13, 2009 at 10:29:36PM +0100, Carsten Breuer wrote:

&gt;<i> &gt; You could also argue that the do_something definition is buggy,
</I>&gt;<i> &gt; since it's not one statement.
</I>&gt;<i> 
</I>&gt;<i> Correct. But if you use brackets the code do what you want and
</I>&gt;<i> you get the result what you expect.
</I>
Sure, but if you use brackets in the macro, the code does what you
want as well. :)  The main downside for me of mandating brackets in
the caller is that it wastes vertical space, which tends to be
scarce.  But yes, you'll have to trust whomever defined the macro to
not have done something stupid, which you can't always rely on.


&gt;<i> Lint complains about both.
</I>
I'm not sure if Lint is a good standard. :)


&gt;<i> &gt; E.g. the Linux kernel takes this stance, and wraps such macros in do
</I>&gt;<i> &gt; { } while (0) blocks:
</I>&gt;<i> &gt; #define local_irq_enable() \ do { trace_hardirqs_on();
</I>&gt;<i> &gt; raw_local_irq_enable(); } while (0) #define local_irq_disable() \ do
</I>&gt;<i> &gt; { raw_local_irq_disable(); trace_hardirqs_off(); } while (0)
</I>&gt;<i> 
</I>&gt;<i> One possible way, but a bit tricky.
</I>&gt;<i> In most code you have the time to use inline functions (C99)
</I>&gt;<i> instead of makros. We use them a lot and try too avoid
</I>&gt;<i> any preprocessor macros at all.
</I>
In cases where they can be used (i.e. the macro doesn't modify any
of its arguments), I definitely prefer inline functions as well.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013531.html">[Openocd-development] OpenOCD broken
</A></li>
	<LI>Next message: <A HREF="013534.html">[Openocd-development] OpenOCD [not] broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13532">[ date ]</a>
              <a href="thread.html#13532">[ thread ]</a>
              <a href="subject.html#13532">[ subject ]</a>
              <a href="author.html#13532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
