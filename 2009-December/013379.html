<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] [RFC] common flash work (generic objects)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-December/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BRFC%5D%20common%20flash%20work%20%28generic%20objects%29&In-Reply-To=%3C1260019238.27619.7072.camel%40localhost%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013376.html">
   <LINK REL="Next"  HREF="013381.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] [RFC] common flash work (generic objects)</H1>
    <B>Zach Welch</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BRFC%5D%20common%20flash%20work%20%28generic%20objects%29&In-Reply-To=%3C1260019238.27619.7072.camel%40localhost%3E"
       TITLE="[Openocd-development] [RFC] common flash work (generic objects)">zw at superlucidity.net
       </A><BR>
    <I>Sat Dec  5 14:20:38 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="013376.html">[Openocd-development] RC1 in a couple weeks ...
</A></li>
        <LI>Next message: <A HREF="013381.html">[Openocd-development] [PATCH 1/4] - add 29LV400BC flash device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13379">[ date ]</a>
              <a href="thread.html#13379">[ thread ]</a>
              <a href="subject.html#13379">[ subject ]</a>
              <a href="author.html#13379">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

The master branch on my repo.or.cz mirror has a couple of patches that
begin to unify the flash tree, which will eventually lead to the
elimination of a bit more duplicated code.  It's using the container_of
macro first used by the target module.  The first patch introduces the
basic scaffolding, and the second converts the NOR driver and bank
structures to use it.  These build but are untested.  I should have the
NAND directory converted after a little more work.  When this is cleaned
up and pushed, it will be easy to support new classes of flash devices.

I think the driver/instance abstractions deserve to be generalized into
a lower-level/helper API that provide the generic driver loading and
instantiation mechanisms for all of our &quot;classes and their objects&quot;.
In other words, the core foundation for interface, jtag, flash, target,
and all other kinds of things that will have N drivers and M instances.

Each of these will need the same infrastructure: find and load driver
modules, register each module's driver(s) and base commands, and provide
a means of creating new instances and installing them into the command
system.  All of this could be done as part of an 'object' helper module.
If we implement this today, moving from static to dynamic modules could
be done in that single source file, behind the veil of its API.

Cheers,

Zach

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013376.html">[Openocd-development] RC1 in a couple weeks ...
</A></li>
	<LI>Next message: <A HREF="013381.html">[Openocd-development] [PATCH 1/4] - add 29LV400BC flash device
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13379">[ date ]</a>
              <a href="thread.html#13379">[ thread ]</a>
              <a href="subject.html#13379">[ subject ]</a>
              <a href="author.html#13379">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
