<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] [PATCH] spaces to tabs for openocd.c
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2008-July/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPATCH%5D%20spaces%20to%20tabs%20for%20openocd.c&In-Reply-To=%3C200807072225.m67MPC6B020483%40hades%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002420.html">
   <LINK REL="Next"  HREF="002423.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] [PATCH] spaces to tabs for openocd.c</H1>
    <B>Charles Hardin</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20%5BPATCH%5D%20spaces%20to%20tabs%20for%20openocd.c&In-Reply-To=%3C200807072225.m67MPC6B020483%40hades%3E"
       TITLE="[Openocd-development] [PATCH] spaces to tabs for openocd.c">ckhardin at gmail.com
       </A><BR>
    <I>Tue Jul  8 00:25:12 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002420.html">[Openocd-development] reset scripts
</A></li>
        <LI>Next message: <A HREF="002423.html">[Openocd-development] [PATCH] spaces to tabs for openocd.c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2422">[ date ]</a>
              <a href="thread.html#2422">[ thread ]</a>
              <a href="subject.html#2422">[ subject ]</a>
              <a href="author.html#2422">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry to be one of those people, but the diffs were getting to me even with
ignoring whitespace. So, just went by the README.

- use TAB characters for indentation, not spaces
- displayed TAB width is 4 characters

Thanks
Index: src/openocd.c
===================================================================
--- src/openocd.c	(revision 769)
+++ src/openocd.c	(working copy)
@@ -197,16 +197,16 @@
 
 	namebuf = alloc_printf(&quot;%s(%d)&quot;, varname, idx );
 	
-    nameObjPtr = Jim_NewStringObj(interp, namebuf, -1);
-    valObjPtr = Jim_NewIntObj(interp, val );
-    Jim_IncrRefCount(nameObjPtr);
-    Jim_IncrRefCount(valObjPtr);
-    result = Jim_SetVariable(interp, nameObjPtr, valObjPtr);
-    Jim_DecrRefCount(interp, nameObjPtr);
-    Jim_DecrRefCount(interp, valObjPtr);
-    free(namebuf);
+	nameObjPtr = Jim_NewStringObj(interp, namebuf, -1);
+	valObjPtr = Jim_NewIntObj(interp, val );
+	Jim_IncrRefCount(nameObjPtr);
+	Jim_IncrRefCount(valObjPtr);
+	result = Jim_SetVariable(interp, nameObjPtr, valObjPtr);
+	Jim_DecrRefCount(interp, nameObjPtr);
+	Jim_DecrRefCount(interp, valObjPtr);
+	free(namebuf);
 	// printf( &quot;%s = 0%08x\n&quot;, namebuf, val );
-    return result;
+	return result;
 }
 
 static int Jim_Command_mem2array(Jim_Interp *interp, int argc, Jim_Obj *const *argv)
@@ -262,48 +262,48 @@
 		break;
 	default:
 		Jim_SetResult(interp, 
-					  Jim_NewEmptyStringObj(interp));
+			      Jim_NewEmptyStringObj(interp));
 		Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   &quot;Invalid width param, must be 8/16/32&quot;, NULL );
+				   &quot;Invalid width param, must be 8/16/32&quot;, NULL );
 		return JIM_ERR;
 	}
 	if( len == 0 ){
 		Jim_SetResult(interp, 
-					  Jim_NewEmptyStringObj(interp));
+			      Jim_NewEmptyStringObj(interp));
 		Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   &quot;mem2array: zero width read?&quot;, NULL );
+				   &quot;mem2array: zero width read?&quot;, NULL );
 		return JIM_ERR;
 	}
 	if( (addr + (len * width)) &lt; addr ){
 		Jim_SetResult(interp, 
-					  Jim_NewEmptyStringObj(interp));
+			      Jim_NewEmptyStringObj(interp));
 		Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   &quot;mem2array: addr + len - wraps to zero?&quot;, NULL );
+				   &quot;mem2array: addr + len - wraps to zero?&quot;, NULL );
 		return JIM_ERR;
 	}
 	/* absurd transfer size? */
 	if( len &gt; 65536 ){
 		Jim_SetResult(interp, 
-					  Jim_NewEmptyStringObj(interp));
+			      Jim_NewEmptyStringObj(interp));
 		Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   &quot;mem2array: absurd &gt; 64K item request&quot;, NULL );
+				   &quot;mem2array: absurd &gt; 64K item request&quot;, NULL );
 		return JIM_ERR;
 	}		
 		
 	if( (width == 1) ||
-		((width == 2) &amp;&amp; ((addr &amp; 1) == 0)) ||
-		((width == 4) &amp;&amp; ((addr &amp; 3) == 0)) ){
+	    ((width == 2) &amp;&amp; ((addr &amp; 1) == 0)) ||
+	    ((width == 4) &amp;&amp; ((addr &amp; 3) == 0)) ){
 		/* all is well */
 	} else {
 		char buf[100];
 		Jim_SetResult(interp, 
-					  Jim_NewEmptyStringObj(interp));
+			      Jim_NewEmptyStringObj(interp));
 		sprintf( buf, 
-				 &quot;mem2array address: 0x%08x is not aligned for %d byte reads&quot;,
-				 addr, width );
+			 &quot;mem2array address: 0x%08x is not aligned for %d byte reads&quot;,
+			 addr, width );
 				 
 		Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   buf , NULL );
+				   buf , NULL );
 		return JIM_ERR;
 	}
 
@@ -324,20 +324,17 @@
 			count = (sizeof(buffer)/width);
 		}
 		
-		retval = target-&gt;type-&gt;read_memory( target, 
-											addr, 
-											width, 
-											count,
-											buffer );
+		retval = target-&gt;type-&gt;read_memory(target, addr, width, 
+						   count, buffer);
 
 		if( retval != ERROR_OK ){
 			/* BOO !*/
 			LOG_ERROR(&quot;mem2array: Read @ 0x%08x, w=%d, cnt=%d, failed&quot;,
-					  addr, width, count );
+				  addr, width, count );
 			Jim_SetResult(interp, 
-						  Jim_NewEmptyStringObj(interp));
+				      Jim_NewEmptyStringObj(interp));
 			Jim_AppendStrings( interp, Jim_GetResult(interp),
-						   &quot;mem2array: cannot read memory&quot;, NULL );
+					   &quot;mem2array: cannot read memory&quot;, NULL );
 			e = JIM_ERR;
 			len = 0;
 		} else {
@@ -360,7 +357,7 @@
 		}
 	}
 	Jim_SetResult(interp, 
-				  Jim_NewEmptyStringObj(interp));
+		      Jim_NewEmptyStringObj(interp));
 
 	return JIM_OK;
 }
@@ -385,50 +382,51 @@
 	
 	const char *result;
 	int reslen;
-    result = Jim_GetString(Jim_GetResult(interp), &amp;reslen);
-    if (retcode == JIM_ERR) {
-	    int len, i;
+
+	result = Jim_GetString(Jim_GetResult(interp), &amp;reslen);
+	if (retcode == JIM_ERR) {
+		int len, i;
 	
-	    LOG_USER_N(&quot;Runtime error, file \&quot;%s\&quot;, line %d:&quot; JIM_NL,
-	            interp-&gt;errorFileName, interp-&gt;errorLine);
-	    LOG_USER_N(&quot;    %s&quot; JIM_NL,
-	            Jim_GetString(interp-&gt;result, NULL));
-	    Jim_ListLength(interp, interp-&gt;stackTrace, &amp;len);
-	    for (i = 0; i &lt; len; i+= 3) {
-	        Jim_Obj *objPtr;
-	        const char *proc, *file, *line;
+		LOG_USER_N(&quot;Runtime error, file \&quot;%s\&quot;, line %d:&quot; JIM_NL,
+			   interp-&gt;errorFileName, interp-&gt;errorLine);
+		LOG_USER_N(&quot;    %s&quot; JIM_NL,
+			   Jim_GetString(interp-&gt;result, NULL));
+		Jim_ListLength(interp, interp-&gt;stackTrace, &amp;len);
+		for (i = 0; i &lt; len; i+= 3) {
+			Jim_Obj *objPtr;
+			const char *proc, *file, *line;
 	
-	        Jim_ListIndex(interp, interp-&gt;stackTrace, i, &amp;objPtr, JIM_NONE);
-	        proc = Jim_GetString(objPtr, NULL);
-	        Jim_ListIndex(interp, interp-&gt;stackTrace, i+1, &amp;objPtr,
-	                JIM_NONE);
-	        file = Jim_GetString(objPtr, NULL);
-	        Jim_ListIndex(interp, interp-&gt;stackTrace, i+2, &amp;objPtr,
-	                JIM_NONE);
-	        line = Jim_GetString(objPtr, NULL);
-	        LOG_USER_N(&quot;In procedure '%s' called at file \&quot;%s\&quot;, line %s&quot; JIM_NL,
-	                proc, file, line);
-	    }
-    } else if (retcode == JIM_EXIT) {
-    	// ignore.
-        //exit(Jim_GetExitCode(interp));
-    } else {
-        if (reslen) {
-        	int i;
-        	char buff[256+1];
-        	for (i=0; i&lt;reslen; i+=256)
-        	{
-        		int chunk;
-        		chunk=reslen-i;
-        		if (chunk&gt;256)
-        			chunk=256;
-        		strncpy(buff, result, chunk);
-        		buff[chunk]=0; 
-            	LOG_USER_N(&quot;%s&quot;, buff);
-        	}
-        	LOG_USER_N(&quot;%s&quot;, &quot;\n&quot;);
-        }
-    }
+			Jim_ListIndex(interp, interp-&gt;stackTrace, i, &amp;objPtr, JIM_NONE);
+			proc = Jim_GetString(objPtr, NULL);
+			Jim_ListIndex(interp, interp-&gt;stackTrace, i+1, &amp;objPtr,
+				      JIM_NONE);
+			file = Jim_GetString(objPtr, NULL);
+			Jim_ListIndex(interp, interp-&gt;stackTrace, i+2, &amp;objPtr,
+				      JIM_NONE);
+			line = Jim_GetString(objPtr, NULL);
+			LOG_USER_N(&quot;In procedure '%s' called at file \&quot;%s\&quot;, line %s&quot; JIM_NL,
+				   proc, file, line);
+		}
+	} else if (retcode == JIM_EXIT) {
+		// ignore.
+		//exit(Jim_GetExitCode(interp));
+	} else {
+		if (reslen) {
+			int i;
+			char buff[256+1];
+			for (i=0; i&lt;reslen; i+=256)
+			{
+				int chunk;
+				chunk=reslen-i;
+				if (chunk&gt;256)
+					chunk=256;
+				strncpy(buff, result, chunk);
+				buff[chunk]=0; 
+				LOG_USER_N(&quot;%s&quot;, buff);
+			}
+			LOG_USER_N(&quot;%s&quot;, &quot;\n&quot;);
+		}
+	}
 	return retval;
 }
 
@@ -437,28 +435,28 @@
 static int Jim_Command_openocd_ignore(Jim_Interp *interp, int argc, Jim_Obj *const *argv, int ignore)
 {
 	int retval;
-    char *cmd = (char*)Jim_GetString(argv[1], NULL);
+	char *cmd = (char*)Jim_GetString(argv[1], NULL);
 
-    Jim_Obj *tclOutput = Jim_NewStringObj(interp, &quot;&quot;, 0);
+	Jim_Obj *tclOutput = Jim_NewStringObj(interp, &quot;&quot;, 0);
     
-    if (startLoop)
-    {
-    	// We don't know whether or not the telnet/gdb server is running...
-    	target_call_timer_callbacks_now();
-    }
+	if (startLoop)
+	{
+		// We don't know whether or not the telnet/gdb server is running...
+		target_call_timer_callbacks_now();
+	}
 	
 	log_add_callback(tcl_output, tclOutput);
-    retval=command_run_line_internal(active_cmd_ctx, cmd);
+	retval=command_run_line_internal(active_cmd_ctx, cmd);
     
-    if (startLoop)
-    {
-    	target_call_timer_callbacks_now();
-    }
+	if (startLoop)
+	{
+		target_call_timer_callbacks_now();
+	}
 	log_remove_callback(tcl_output, tclOutput);
     
 	Jim_SetResult(interp, tclOutput);
         
-    return (ignore||(retval==ERROR_OK))?JIM_OK:JIM_ERR;
+	return (ignore||(retval==ERROR_OK))?JIM_OK:JIM_ERR;
 }
 
 static int Jim_Command_openocd(Jim_Interp *interp, int argc, Jim_Obj *const *argv)
@@ -480,8 +478,8 @@
 	char *full_path=find_file(file);
 	if (full_path==NULL)
 		return JIM_ERR;
-    Jim_Obj *result = Jim_NewStringObj(interp, full_path, strlen(full_path));
-    free(full_path);
+	Jim_Obj *result = Jim_NewStringObj(interp, full_path, strlen(full_path));
+	free(full_path);
     
 	Jim_SetResult(interp, result);
 	return JIM_OK;
@@ -580,11 +578,11 @@
 
 void initJim(void)
 {
-    Jim_CreateCommand(interp, &quot;openocd&quot;, Jim_Command_openocd, NULL, NULL);
-    Jim_CreateCommand(interp, &quot;openocd_throw&quot;, Jim_Command_openocd_throw, NULL, NULL);
-    Jim_CreateCommand(interp, &quot;find&quot;, Jim_Command_find, NULL, NULL);
-    Jim_CreateCommand(interp, &quot;echo&quot;, Jim_Command_echo, NULL, NULL);
-    Jim_CreateCommand(interp, &quot;mem2array&quot;, Jim_Command_mem2array, NULL, NULL );
+	Jim_CreateCommand(interp, &quot;openocd&quot;, Jim_Command_openocd, NULL, NULL);
+	Jim_CreateCommand(interp, &quot;openocd_throw&quot;, Jim_Command_openocd_throw, NULL, NULL);
+	Jim_CreateCommand(interp, &quot;find&quot;, Jim_Command_find, NULL, NULL);
+	Jim_CreateCommand(interp, &quot;echo&quot;, Jim_Command_echo, NULL, NULL);
+	Jim_CreateCommand(interp, &quot;mem2array&quot;, Jim_Command_mem2array, NULL, NULL );
 
 	/* Set Jim's STDIO */
 	interp-&gt;cookie_stdin  = NULL;
@@ -664,12 +662,12 @@
 {
 #ifdef JIM_EMBEDDED
 	Jim_InitEmbedded();
-    /* Create an interpreter */
-    interp = Jim_CreateInterp();
-    /* Add all the Jim core commands */
-    Jim_RegisterCoreCommands(interp);
+	/* Create an interpreter */
+	interp = Jim_CreateInterp();
+	/* Add all the Jim core commands */
+	Jim_RegisterCoreCommands(interp);
 #endif
-    
+
 	initJim();
 	
 	/* initialize commandline interface */
@@ -716,3 +714,4 @@
 
 	return EXIT_SUCCESS;
 }
+

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002420.html">[Openocd-development] reset scripts
</A></li>
	<LI>Next message: <A HREF="002423.html">[Openocd-development] [PATCH] spaces to tabs for openocd.c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2422">[ date ]</a>
              <a href="thread.html#2422">[ thread ]</a>
              <a href="subject.html#2422">[ subject ]</a>
              <a href="author.html#2422">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
