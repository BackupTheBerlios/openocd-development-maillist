<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] RFC: command handler restructuring
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20RFC%3A%20command%20handler%20restructuring&In-Reply-To=%3C1257916741.5610.2585.camel%40localhost%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012175.html">
   <LINK REL="Next"  HREF="012180.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] RFC: command handler restructuring</H1>
    <B>Zach Welch</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20RFC%3A%20command%20handler%20restructuring&In-Reply-To=%3C1257916741.5610.2585.camel%40localhost%3E"
       TITLE="[Openocd-development] RFC: command handler restructuring">zw at superlucidity.net
       </A><BR>
    <I>Wed Nov 11 06:19:01 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="012175.html">[Openocd-development] bug with openocd 0.3.0 with LPC2148	+	workaround
</A></li>
        <LI>Next message: <A HREF="012180.html">[Openocd-development] RFC: command handler restructuring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12178">[ date ]</a>
              <a href="thread.html#12178">[ thread ]</a>
              <a href="subject.html#12178">[ subject ]</a>
              <a href="author.html#12178">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I have updated my repo.or.cz repository with the series of patches that
I have been working on.  There are a few issues that still need to be
worked out, but it shows what I am doing so others can avoid duplicating
(or &quot;helping&quot;) in similar areas.  You can view the changes from here:

  <A HREF="http://repo.or.cz/w/openocd/ztw.git">http://repo.or.cz/w/openocd/ztw.git</A>

My changes started by asking the question: can we change the types used
in the command_s-&gt;handler function signature?  Answer: Yes. Yes, we can.

In short, it starts with a bunch general cleanup issues that serve only
to reduce noise in the remaining patches.  These may deserve to be
pushed before the rest of the series, as they are mostly harmless.
The remainder of the series makes radical (but positive) changes to the
command handler function type signature, improving their maintainability
and making it a little easier to write new commands and their helpers.

The series will be done when we can reorder (or add) parameters to all
command handlers by a one-line patch to command.h (touching no other
files), and it's nearly there already.  For a final coup, I believe that
a small final patch will allow the removal of the 'cmd' parameter from
command handler functions.  That parameter goes unused more often than
not (and the value will still be available when it is needed).

Still known missing is documentation.  That amounts to a chapter in the
developer manual describing how to write new OpenOCD modules/commands.
However, the commit messages walk you through the conversion process,
and they introduce new concepts in their logical order.  The tree should
compile cleanly after each patch is applied.

Testing and feedback would be welcome.  Again, it's not quite done, but
the tree compiles and should work as-is without any regressions.

Cheers,

Zach Welch
Corvallis, OR

P.S. Strategically, I am working to improve the use of types throughout
the system, starting on helpers/ and up.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012175.html">[Openocd-development] bug with openocd 0.3.0 with LPC2148	+	workaround
</A></li>
	<LI>Next message: <A HREF="012180.html">[Openocd-development] RFC: command handler restructuring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12178">[ date ]</a>
              <a href="thread.html#12178">[ thread ]</a>
              <a href="subject.html#12178">[ subject ]</a>
              <a href="author.html#12178">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
