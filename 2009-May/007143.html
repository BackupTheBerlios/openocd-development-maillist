<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] Being careful not to brake anything is	good but ...
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Being%20careful%20not%20to%20brake%20anything%20is%0A%09good%20but%20...&In-Reply-To=%3C530F34C8-B611-4F81-97A5-9A75839A00DF%40kc8apf.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007129.html">
   <LINK REL="Next"  HREF="007145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] Being careful not to brake anything is	good but ...</H1>
    <B>Rick Altherr</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Being%20careful%20not%20to%20brake%20anything%20is%0A%09good%20but%20...&In-Reply-To=%3C530F34C8-B611-4F81-97A5-9A75839A00DF%40kc8apf.net%3E"
       TITLE="[Openocd-development] Being careful not to brake anything is	good but ...">kc8apf at kc8apf.net
       </A><BR>
    <I>Sun May 24 03:42:14 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="007129.html">[Openocd-development] Being careful not to brake anything is good	but ...
</A></li>
        <LI>Next message: <A HREF="007145.html">[Openocd-development] Being careful not to brake anything is good but ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7143">[ date ]</a>
              <a href="thread.html#7143">[ thread ]</a>
              <a href="subject.html#7143">[ subject ]</a>
              <a href="author.html#7143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On May 23, 2009, at 1:30 PM, Magnus Lundin wrote:

&gt;<i> Common people
</I>&gt;<i>
</I>&gt;<i> So much soul searching about a oneliner in jtag.c .
</I>&gt;<i>
</I>&gt;<i> Setting the current tap state with  cmd_queue_cur_state = TAP_RESET is
</I>&gt;<i> an obvious error as 5 minutes of code inspection in jtag.c will show  
</I>&gt;<i> you.
</I>&gt;<i>
</I>&gt;<i> The variable is not used in any dr/ir scan code, It is only used in
</I>&gt;<i> jtag_add_path_move to find the start state, and for sanity check in
</I>&gt;<i> jtag_add_clocks. It will be overwritten by the next call to  
</I>&gt;<i> jtag_prelude
</I>&gt;<i> by any ir/dr scan, and all driver code uses tap_get_state() instead.
</I>&gt;<i>
</I>&gt;<i> Actually ALL  uses of  cmd_queue_cur_state should be retired and
</I>&gt;<i> replaced  by correct accessor function tap_get_state(), as it is now  
</I>&gt;<i> we
</I>&gt;<i> have two variables tracing the current tap state, cmd_queue_cur_state
</I>&gt;<i> and state_follower.
</I>&gt;<i>
</I>&gt;<i> I am not saying that nothing will change from this, it most probably
</I>&gt;<i> will, but the old code is broken and perhaps it is time to fix it.
</I>&gt;<i>
</I>&gt;<i> Have a nice weekend
</I>&gt;<i> Magnus
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Openocd-development mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">Openocd-development at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">https://lists.berlios.de/mailman/listinfo/openocd-development</A>
</I>

I don't think anyone is &quot;soul searching&quot; or avoiding this because it  
in the jtag common code.  I know I've been busy the past few days.  I  
believe Zach passed on the issue since he isn't familiar with the code  
in any way.  From what I've seen go by on the list, this has been  
tested and has either no immediate effect or a positive one.  I plan  
to commit it, but not everyone is working on OpenOCD every day.

--
Rick Altherr
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">kc8apf at kc8apf.net</A>

&quot;He said he hadn't had a byte in three days. I had a short, so I split  
it with him.&quot;
  -- Unsigned



-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2446 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20090523/bf9fd4d9/attachment.bin">https://lists.berlios.de/pipermail/openocd-development/attachments/20090523/bf9fd4d9/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007129.html">[Openocd-development] Being careful not to brake anything is good	but ...
</A></li>
	<LI>Next message: <A HREF="007145.html">[Openocd-development] Being careful not to brake anything is good but ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7143">[ date ]</a>
              <a href="thread.html#7143">[ thread ]</a>
              <a href="subject.html#7143">[ subject ]</a>
              <a href="author.html#7143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
