<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] TMS470 Scripts
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20TMS470%20Scripts&In-Reply-To=%3Cfd211a420905271630w6b8b7adyf3255046e7a8fcb%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007465.html">
   <LINK REL="Next"  HREF="007530.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] TMS470 Scripts</H1>
    <B>Dylan Reid</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20TMS470%20Scripts&In-Reply-To=%3Cfd211a420905271630w6b8b7adyf3255046e7a8fcb%40mail.gmail.com%3E"
       TITLE="[Openocd-development] TMS470 Scripts">dgreid at gmail.com
       </A><BR>
    <I>Thu May 28 01:30:21 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="007465.html">[Openocd-development] TMS470 Scripts
</A></li>
        <LI>Next message: <A HREF="007530.html">[Openocd-development] TMS470 Scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7406">[ date ]</a>
              <a href="thread.html#7406">[ thread ]</a>
              <a href="subject.html#7406">[ subject ]</a>
              <a href="author.html#7406">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I updated to 1933 today and gave my j-links another try loading code
to a STM32.  I tried a v3 v4 and v6 jlink.  The v4 jlink worked
reliably, v3 worked after trying a few times and power cycling
everything.  v6 won't work at all.  I attached the console output of
all three jlink sessions.



On Wed, May 27, 2009 at 6:06 PM, Peter Denison &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">openwrt at marshadder.org</A>&gt; wrote:
&gt;<i> On Wed, 27 May 2009, Xiaofan Chen wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Thanks a lot for the help. I could not connect the TMS470R1A256 IAR
</I>&gt;&gt;<i> Starter Kit properly to J-Link with the script. I have not used your patch
</I>&gt;&gt;<i> yet as it seems more for the debugging part. I want to connect and then
</I>&gt;&gt;<i> reset/halt first.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">mcuee at ubuntu904</A>:~/Desktop/build/openocd/tms470$ openocd -f tms470r1a256.cfg
</I>&gt;&gt;<i> Open On-Chip Debugger 0.2.0-in-development (2009-05-25-21:15) svn:1910
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> $URL: <A HREF="svn://svn.berlios.de/openocd/trunk/src/openocd.c">svn://svn.berlios.de/openocd/trunk/src/openocd.c</A> $
</I>&gt;&gt;<i> Error: J-Link command EMU_CMD_VERSION failed (-110)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Error: J-Link command EMU_CMD_VERSION impossible return length 0x2d4a
</I>&gt;&gt;<i> Error: J-Link command EMU_CMD_VERSION failed (-110)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Info : J-Link ARM V6 compiled Apr &#160;1 2009 11:56:10
</I>&gt;&gt;<i> Info : JLink caps 0x19ff7bbf
</I>&gt;&gt;<i> Info : JLink hw version 60000
</I>&gt;&gt;<i> Info : JLink max mem block 8376
</I>&gt;&gt;<i> Info : Vref = 3.132 TCK = 1 TDI = 0 TDO = 0 TMS = 0 SRST = 1 TRST = 1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Info : J-Link JTAG Interface ready
</I>&gt;&gt;<i> Warn : keep_alive() was not invoked in the 1000ms timelimit. GDB alive
</I>&gt;&gt;<i> packet not sent! (6118). Workaround: increase &quot;set remotetimeout&quot; in
</I>&gt;&gt;<i> GDB
</I>&gt;&gt;<i> Error: jlink_usb_message failed with result=1)
</I>&gt;&gt;<i> Error: jlink_tap_execute, wrong result -107 (expected 1)
</I>&gt;<i>
</I>&gt;<i> I get this repeated result as well, with a Yellow V6 J-Link, and a
</I>&gt;<i> USR8200 (IXP422) target board:
</I>&gt;<i>
</I>&gt;<i> --------------------------8&lt;--------------------------------
</I>&gt;<i> Open On-Chip Debugger 0.2.0-in-development (2009-05-27-19:22) svn:1932M
</I>&gt;<i>
</I>&gt;<i> BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>
</I>&gt;<i>
</I>&gt;<i> $URL: <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c">http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c</A> $
</I>&gt;<i> RCLK - adaptive
</I>&gt;<i> Error: J-Link command EMU_CMD_VERSION failed (-110)
</I>&gt;<i>
</I>&gt;<i> Error: J-Link command EMU_CMD_VERSION impossible return length 0x2d4a
</I>&gt;<i> Error: J-Link command EMU_CMD_VERSION failed (-110)
</I>&gt;<i>
</I>&gt;<i> Info : J-Link ARM V6 compiled Mar &#160;3 2008 18:04:42
</I>&gt;<i> Info : JLink caps 0x1f7fbf
</I>&gt;<i> Info : JLink hw version 60000
</I>&gt;<i> Info : JLink max mem block 9992
</I>&gt;<i> Info : Vref = 3.313 TCK = 1 TDI = 0 TDO = 1 TMS = 0 SRST = 1 TRST = 1
</I>&gt;<i>
</I>&gt;<i> Info : J-Link JTAG Interface ready
</I>&gt;<i> Warn : keep_alive() was not invoked in the 1000ms timelimit. GDB alive packet not sent! (6211). Workaround: increase &quot;set remotetimeout&quot; in GDB
</I>&gt;<i> Error: jlink_usb_message failed with result=1)
</I>&gt;<i> Error: jlink_tap_execute, wrong result -107 (expected 1)
</I>&gt;<i> ------------------------8&lt;----------------------------------
</I>&gt;<i>
</I>&gt;<i> The offending lines that cause it to break were added in jlink.c by Oyvind
</I>&gt;<i> in r1498. However, according to the docs (RM08001-02, dated June 30,
</I>&gt;<i> 2008 at www.segger.com), they should be correct. Once you've read the TDO
</I>&gt;<i> lines out, read the next byte out, and if it's 0, it's OK, if not, it's an
</I>&gt;<i> error. Sadly, the docs don't go on to explain what an error code of 1
</I>&gt;<i> means.
</I>&gt;<i>
</I>&gt;<i> Mine is consistently reading out a 1 instead of a 0.
</I>&gt;<i>
</I>&gt;<i> As an aside, the new 'jlink hw jtag' command is a good idea, but the
</I>&gt;<i> hardware version read from the adapter always overrides any command line
</I>&gt;<i> value you've put in.
</I>&gt;<i>
</I>&gt;<i> I'm seriously considering ditching the J-Link, and going back to trying to
</I>&gt;<i> get the USBprog to be a fully featured JTAG adapter. It's more work, but
</I>&gt;<i> at least both ends are open source. (Twice as many communities to interact
</I>&gt;<i> with - yay ;)
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Openocd-development mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">Openocd-development at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">https://lists.berlios.de/mailman/listinfo/openocd-development</A>
</I>&gt;<i>
</I>-------------- next part --------------
(54)$ sudo /usr/local/gnu-arm/bin/openocd -f ../GNUTools/openOCD/newLPM.cfg -c init -c &quot;sleep 200&quot; -f flashAll.script -c &quot;reset run&quot; -c &quot;shutdown&quot;
Open On-Chip Debugger 0.2.0-in-development (2009-05-27-16:57) svn:1933


BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>


$URL: <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c">http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c</A> $
500 kHz
Info : J-Link compiled Feb 20 2006 18:20:20 -- Update --
Info : JLink caps 0x3
Info : JLink hw version 30000
Info : Vref = 3.279 TCK = 1 TDI = 0 TDO = 1 TMS = 0 SRST = 1 TRST = 255

Info : J-Link JTAG Interface ready
Info : JTAG tap: stm32.cpu tap/device found: 0x3ba00477 (Manufacturer: 0x23b, Part: 0xba00, Version: 0x3)
Info : JTAG Tap/device matched
Info : JTAG tap: stm32.bs tap/device found: 0x06414041 (Manufacturer: 0x020, Part: 0x6414, Version: 0x0)
Info : JTAG Tap/device matched
Info : device id = 0x10016414
Info : flash size = 256kbytes
stm32x mass erase complete
Info : Padding image section 0 with 0 bytes
Error: timed out while waiting for target halted
Error: error executing stm32x flash write algorithm
Error: flash writing failed with error code: 0xfffffc7a
Error: error writing to flash at address 0x08000000 at offset 0x00000000 (-902)
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ 
(55)$ sudo /usr/local/gnu-arm/bin/openocd -f ../GNUTools/openOCD/newLPM.cfg -c init -c &quot;sleep 200&quot; -f flashAll.script -c &quot;reset run&quot; -c &quot;shutdown&quot;
Open On-Chip Debugger 0.2.0-in-development (2009-05-27-16:57) svn:1933


BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>


$URL: <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c">http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c</A> $
500 kHz
Error: J-Link command EMU_CMD_VERSION failed (-110)

Info : J-Link compiled Feb 20 2006 18:20:20 -- Update --
Info : JLink caps 0x3
Info : JLink hw version 30000
Info : Vref = 3.272 TCK = 1 TDI = 0 TDO = 1 TMS = 0 SRST = 1 TRST = 255

Info : J-Link JTAG Interface ready
Info : JTAG tap: stm32.cpu tap/device found: 0x3ba00477 (Manufacturer: 0x23b, Part: 0xba00, Version: 0x3)
Info : JTAG Tap/device matched
Info : JTAG tap: stm32.bs tap/device found: 0x06414041 (Manufacturer: 0x020, Part: 0x6414, Version: 0x0)
Info : JTAG Tap/device matched
Warn : target was in unknown state when halt was requested
Info : device id = 0x10016414
Info : flash size = 256kbytes
stm32x mass erase complete
Info : Padding image section 0 with 0 bytes
wrote 6844 byte from file ../BootLoader/source/bl.elf in 0.804921s (8.303416 kb/s)
wrote 150484 byte from file lpm.bin in 14.385707s (10.215489 kb/s)
Info : JTAG tap: stm32.cpu tap/device found: 0x3ba00477 (Manufacturer: 0x23b, Part: 0xba00, Version: 0x3)
Info : JTAG Tap/device matched
Info : JTAG tap: stm32.bs tap/device found: 0x06414041 (Manufacturer: 0x020, Part: 0x6414, Version: 0x0)
Info : JTAG Tap/device matched
(56)$ 
-------------- next part --------------
(57)$ sudo /usr/local/gnu-arm/bin/openocd -f ../GNUTools/openOCD/newLPM.cfg -c init -c &quot;sleep 200&quot; -f flashAll.script -c &quot;reset run&quot; -c &quot;shutdown&quot;
Open On-Chip Debugger 0.2.0-in-development (2009-05-27-16:57) svn:1933


BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>


$URL: <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c">http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c</A> $
500 kHz
Info : J-Link compiled Feb 20 2006 18:20:20 -- Update --
Info : JLink caps 0x3
Info : JLink hw version 40000
Info : Vref = 3.273 TCK = 1 TDI = 0 TDO = 1 TMS = 0 SRST = 1 TRST = 255

Info : J-Link JTAG Interface ready
Info : JTAG tap: stm32.cpu tap/device found: 0x3ba00477 (Manufacturer: 0x23b, Part: 0xba00, Version: 0x3)
Info : JTAG Tap/device matched
Info : JTAG tap: stm32.bs tap/device found: 0x06414041 (Manufacturer: 0x020, Part: 0x6414, Version: 0x0)
Info : JTAG Tap/device matched
Warn : target was in unknown state when halt was requested
Info : device id = 0x10016414
Info : flash size = 256kbytes
stm32x mass erase complete
Info : Padding image section 0 with 0 bytes
wrote 6844 byte from file ../BootLoader/source/bl.elf in 0.754868s (8.853990 kb/s)
wrote 150484 byte from file lpm.bin in 14.465284s (10.159291 kb/s)
Info : JTAG tap: stm32.cpu tap/device found: 0x3ba00477 (Manufacturer: 0x23b, Part: 0xba00, Version: 0x3)
Info : JTAG Tap/device matched
Info : JTAG tap: stm32.bs tap/device found: 0x06414041 (Manufacturer: 0x020, Part: 0x6414, Version: 0x0)
Info : JTAG Tap/device matched
(58)$ 
-------------- next part --------------
sudo /usr/local/gnu-arm/bin/openocd -f ../GNls/openOCD/newLPM.cfg -c init -c &quot;sleep 200&quot; -f flashAll.script -c &quot;reset run&quot; -c &quot;shutdown&quot;
Open On-Chip Debugger 0.2.0-in-development (2009-05-27-16:57) svn:1933


BUGS? Read <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS">http://svn.berlios.de/svnroot/repos/openocd/trunk/BUGS</A>


$URL: <A HREF="http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c">http://svn.berlios.de/svnroot/repos/openocd/trunk/src/openocd.c</A> $
500 kHz
Error: J-Link command EMU_CMD_VERSION failed (-110)

Error: J-Link command EMU_CMD_VERSION impossible return length 0x2d4a
Error: J-Link command EMU_CMD_VERSION failed (-110)

Info : J-Link ARM V6 compiled Aug 28 2007 19:22:02
Info : JLink caps 0x77fbf
Info : JLink hw version 60000
Info : JLink max mem block 9992
Info : Vref = 3.306 TCK = 1 TDI = 0 TDO = 1 TMS = 0 SRST = 1 TRST = 1

Info : J-Link JTAG Interface ready
Error: usb_bulk_read failed (requested=1, result=-110)
Error: jlink_tap_execute, wrong result -107 (expected 1)
Error: usb_bulk_read failed (requested=1, result=-110)
Error: jlink_tap_execute, wrong result -107 (expected 1)
Error: usb_bulk_read failed (requested=1, result=-110)
Error: jlink_tap_execute, wrong result -107 (expected 1)
Error: usb_bulk_read failed (requested=1, result=-110)
Error: jlink_tap_execute, wrong result -107 (expected 1)
Error: Target not examined yet
Runtime error, file &quot;flashAll.script&quot;, line 1:
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007465.html">[Openocd-development] TMS470 Scripts
</A></li>
	<LI>Next message: <A HREF="007530.html">[Openocd-development] TMS470 Scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7406">[ date ]</a>
              <a href="thread.html#7406">[ thread ]</a>
              <a href="subject.html#7406">[ subject ]</a>
              <a href="author.html#7406">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
