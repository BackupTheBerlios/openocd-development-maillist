<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-development] Problem loading to CFI flash
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-development/2010-December/index.html" >
   <LINK REL="made" HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Problem%20loading%20to%20CFI%20flash&In-Reply-To=%3C9202BB1E33AC42499AD50D6B84A541E1%40JONATHAN%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017645.html">
   <LINK REL="Next"  HREF="017691.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-development] Problem loading to CFI flash</H1>
    <B>Jonathan dumaresq</B> 
    <A HREF="mailto:openocd-development%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-development%5D%20Problem%20loading%20to%20CFI%20flash&In-Reply-To=%3C9202BB1E33AC42499AD50D6B84A541E1%40JONATHAN%3E"
       TITLE="[Openocd-development] Problem loading to CFI flash">jdumaresq at cimeq.qc.ca
       </A><BR>
    <I>Fri Dec 17 16:36:52 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="017645.html">[Openocd-development] Problem loading to CFI flash
</A></li>
        <LI>Next message: <A HREF="017691.html">[Openocd-development] Problem loading to CFI flash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17679">[ date ]</a>
              <a href="thread.html#17679">[ thread ]</a>
              <a href="subject.html#17679">[ subject ]</a>
              <a href="author.html#17679">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

Here my first patches to be able to use the CFI driver on cortex M3 with the
helper code on target. This is probably not the better way of doing it, but
at least it's work. This have been tested on real hardware. The default cfg
that enable the fsmc can be used. Right now only the 16 bit interface has
been tested. I can add the 8 and 32 bit if the patch is correct. 

&gt;<i>From my testing, I got 17KB/sec
</I>
I'll apreciate a feedback for thoses patches. Since this is nearly my first
git pacthes... 

Regards

Jonathan Dumaresq
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">openocd-development-bounces at lists.berlios.de</A> wrote:
&gt;<i> Hi Spen,
</I>&gt;<i> 
</I>&gt;<i> I'm happy that i'm not the only one !!!
</I>&gt;<i> 
</I>&gt;<i> Is it possible to send or put somewhere a windows version that works
</I>&gt;<i> ? I have never compiled openocd so, if you can provide the binary
</I>&gt;<i> file i'll be happy. If not I can try to compiled it too.  
</I>&gt;<i> 
</I>&gt;<i> Regards
</I>&gt;<i> 
</I>&gt;<i> Jonathan
</I>&gt;<i> Spencer Oliver wrote:
</I>&gt;&gt;<i> On 06/12/2010 14:42, Jonathan dumaresq wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Have you fond some time to test this ?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I have run a quick test and it fails for me also.
</I>&gt;&gt;<i> As a quick test i commented out block writes (cfi_write_words) and it
</I>&gt;&gt;<i> works as expected - albeit even slower.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Also found this patch where they have disabled buffer writes for the
</I>&gt;&gt;<i> M29W128. 
</I>&gt;&gt;<i> 
</I>&gt;<i>
</I><A HREF="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdif">http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdif</A>
&gt;<i> f;h=504a3e72208fc6a65924426ff5693982590bccdc
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Investigating there seems to be stack corruption within openocd when
</I>&gt;&gt;<i> using block writes - the timeout param of
</I>&gt;&gt;<i> cfi_spansion_wait_status_busy gets clobbered somewhere.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers
</I>&gt;&gt;<i> Spen
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Openocd-development mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">Openocd-development at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openocd-development">https://lists.berlios.de/mailman/listinfo/openocd-development</A>
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-Add-new-loader-for-cortex-m3-16bit-spansion-interface.patch
Type: application/octet-stream
Size: 3413 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment.obj">https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-Add-the-cortex-m3-target-as-possible-target.patch
Type: application/octet-stream
Size: 5234 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment-0001.obj">https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment-0001.obj</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0003-Add-break-point-befor-going-in-target_resume.patch
Type: application/octet-stream
Size: 1646 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment-0002.obj">https://lists.berlios.de/pipermail/openocd-development/attachments/20101217/26daea19/attachment-0002.obj</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017645.html">[Openocd-development] Problem loading to CFI flash
</A></li>
	<LI>Next message: <A HREF="017691.html">[Openocd-development] Problem loading to CFI flash
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17679">[ date ]</a>
              <a href="thread.html#17679">[ thread ]</a>
              <a href="subject.html#17679">[ subject ]</a>
              <a href="author.html#17679">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-development">More information about the Openocd-development
mailing list</a><br>
</body></html>
